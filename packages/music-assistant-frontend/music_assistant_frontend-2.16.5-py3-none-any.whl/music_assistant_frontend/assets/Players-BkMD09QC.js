import{B as P}from"./Button-e3TuKsqx.js";import{C}from"./Container-DgPX0so3.js";import{L as G}from"./ListItem-D1K7sg9F.js";import{d as I,i as T,m as a,a_ as w,l as S,L as D,P as d,ac as F,c as _,b as r,w as n,o as i,e as o,q as g,n as z,F as h,r as k,V as X,v as E,az as q,b4 as R,t as p,aV as x,g as V,u as b,a as A,bJ as W,bf as M,cg as j,k as J}from"./index-B-4Sv7B4.js";import{S as H}from"./constants-CXMxJR4j.js";import{V as K}from"./VToolbar-d-V15Ff7.js";import{a as Q}from"./VBtn-BQgtYRkP.js";import"./index-CBho6rsP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VContainer-DszjXlpy.js";/* empty css              */const Z={style:{"margin-bottom":"10px"}},ee={class:"line-clamp-1"},te={class:"line-clamp-1"},_e=I({__name:"Players",setup(ae){const u=W(),l=T([]),L=a.subscribe_multi([w.PLAYER_CONFIG_UPDATED],()=>{y()});S(L);const v=D(()=>Object.values(a.providers).filter(e=>e.available&&(e.supported_features.includes(d.CREATE_GROUP_PLAYER)||e.supported_features.includes(d.SYNC_PLAYERS))).sort((e,t)=>(e.name||a.providerManifests[e.domain].name).toUpperCase()>(t.name||a.providerManifests[t.domain].name).toUpperCase()?1:-1)),y=async function(){l.value=(await a.getPlayerConfigs()).filter(e=>e.provider!="builtin_player").sort((e,t)=>c(e).localeCompare(c(t)))},$=function(e){a.removePlayer(e).then(()=>{l.value=l.value.filter(t=>t.player_id!=e)})},f=function(e,t){a.getProvider(t)&&u.push(`/settings/editplayer/${e}`)},B=function(e){u.push(`/settings/editplayer/${e}/dsp`)},N=function(e){u.push(`/settings/addgroup/${e.lookup_key}`)},O=function(e){const t=a.players[e];return t?t.type===M.GROUP?t.player_id.startsWith(H)||a.getProvider(t.provider)?.supported_features.includes(d.REMOVE_GROUP_PLAYER):a.getProvider(t.provider)?.supported_features.includes(d.REMOVE_PLAYER):!0},U=function(e){e.enabled=!e.enabled,a.savePlayerConfig(e.player_id,{enabled:e.enabled})},c=function(e){return e.name||a.players[e.player_id]?.name||e.default_name||e.player_id},Y=function(e,t){const s=[{label:"settings.configure",labelArgs:[],action:()=>{f(t.player_id,t.provider)},icon:"mdi-cog",disabled:!a.getProvider(t.provider)},{label:"open_dsp_settings",labelArgs:[],action:()=>{B(t.player_id)},icon:"mdi-equalizer",hide:a.players[t.player_id]?.type===M.GROUP},{label:t.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>{U(t)},icon:"mdi-cancel",hide:!a.getProvider(t.provider)},{label:"settings.documentation",labelArgs:[],action:()=>{j(a.getProviderManifest(t.provider)?.documentation||"")},icon:"mdi-bookshelf",disabled:!a.getProviderManifest(t.provider)?.documentation},{label:"settings.delete",labelArgs:[],action:()=>{$(t.player_id)},icon:"mdi-delete",hide:!O(t.player_id)}];J.emit("contextmenu",{items:s,posX:e.clientX,posY:e.clientY})};return F(()=>a.players,e=>{e&&y()},{immediate:!0}),(e,t)=>(i(),_("div",Z,[r(K,{density:"compact",class:"titlebar",color:"transparent",style:{height:"55px"}},{title:n(()=>[R(p(e.$t("settings.players")),1)]),append:n(()=>[v.value.length>0?(i(),o(x,{key:0,scrim:""},{activator:n(({props:s})=>[r(Q,q(s,{color:"accent",variant:"outlined"}),{default:n(()=>[R(p(e.$t("settings.add_group_player")),1)]),_:1},16)]),default:n(()=>[r(z,{density:"compact"},{default:n(()=>[(i(!0),_(h,null,k(v.value,s=>(i(),o(X,{key:s.domain,style:{"padding-top":"0","padding-bottom":"0","margin-bottom":"0"},title:s.name,onClick:m=>N(s)},{prepend:n(()=>[r(E,{domain:s.domain,size:26,class:"media-thumb",style:{"margin-left":"10px"}},null,8,["domain"])]),_:2},1032,["title","onClick"]))),128))]),_:1})]),_:1})):g("",!0)]),_:1}),r(C,null,{default:n(()=>[(i(!0),_(h,null,k(l.value,s=>(i(),o(G,{key:s.player_id,"show-menu-btn":"",link:"",onMenu:m=>Y(m,s),onClick:m=>f(s.player_id,s.provider)},{prepend:n(()=>[r(E,{domain:b(a).getProviderManifest(s.provider)?.domain||"",size:40,class:"listitem-media-thumb"},null,8,["domain"])]),title:n(()=>[A("div",ee,p(c(s)),1)]),subtitle:n(()=>[A("div",te,p(b(a).getProviderManifest(s.provider)?.name||s.provider),1)]),append:n(()=>[s.enabled?b(a).players[s.player_id]?.available?g("",!0):(i(),o(P,{key:1,icon:"",title:e.$t("settings.player_not_available")},{default:n(()=>[r(V,{icon:"mdi-timer-sand"})]),_:1},8,["title"])):(i(),o(P,{key:0,icon:"",title:e.$t("settings.player_disabled")},{default:n(()=>[r(V,{icon:"mdi-cancel"})]),_:1},8,["title"]))]),_:2},1032,["onMenu","onClick"]))),128))]),_:1})]))}});export{_e as default};
