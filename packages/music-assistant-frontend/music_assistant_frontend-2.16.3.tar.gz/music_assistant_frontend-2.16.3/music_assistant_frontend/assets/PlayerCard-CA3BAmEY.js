import{i as B,N as q,e as g,o,aQ as H,r as W,w as m,aR as Y,aA as j,b0 as C,d as G,h as X,q as f,c as p,V as A,D as E,u as s,b8 as w,b as h,g as k,a as $,t as v,b9 as I,b4 as P,m as r,bf as z,p as J,F as K,be as Z,aU as R,aV as M,aT as V,s as S,$ as Q,ba as x,b1 as N,b2 as ee,aZ as ae,bg as le,ad as te,n as ie,E as oe,J as U,M as se,bd as ne,b6 as re,bk as de,aF as ue,k as me,bh as O,bi as D}from"./index-BLuBzgcR.js";import{B as T}from"./Button-BEhYIX-0.js";import{M as ce}from"./MediaItemThumb-4FqrTjbr.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as pe}from"./VSlider-bRJnej6Z.js";import{V as ye}from"./NowPlayingBadge.vue_vue_type_style_index_0_lang-Dwz4QKKd.js";const ve={props:{width:String,height:String,style:String,allowWheel:Boolean},emits:["update:model-value"],setup(e,t){const n=B(!0),l=q(()=>({class:"player-volume",hideDetails:!0,trackSize:2,thumbSize:n.value?0:10,step:2,elevation:0,style:`width: ${e.width}; height:${e.height}; display: inline-grid; ${e.style}`})),_=q(()=>({...l.value,...t}));return{isThumbHidden:n,playerVolumeProps:_,onWheel:({deltaY:c})=>{if(!e.allowWheel)return;const y=_.value.step,d=t.attrs["model-value"],u=c<0?y:-y;t.emit("update:model-value",d+u)}}}};function be(e,t,n,l,_,i){return o(),g(pe,j(l.playerVolumeProps,{onTouchstart:t[0]||(t[0]=c=>l.isThumbHidden=!1),onTouchend:t[1]||(t[1]=c=>l.isThumbHidden=!0),onMouseenter:t[2]||(t[2]=c=>l.isThumbHidden=!1),onMouseleave:t[3]||(t[3]=c=>l.isThumbHidden=!0),onWheel:C(l.onWheel,["prevent"]),onEnd:t[4]||(t[4]=c=>e.$emit("update:model-value",c))}),H({_:2},[W(e.$slots,(c,y)=>({name:y,fn:m(()=>[Y(e.$slots,y,{},void 0,!0)])}))]),1040,["onWheel"])}const F=L(ve,[["render",be],["__scopeId","data-v-af51e13c"]]),fe={key:1,class:"text-caption volumecaption"},ge={key:0,class:"text-caption volumecaption"},he=G({__name:"VolumeControl",props:{player:{},showSyncControls:{type:Boolean},showSubPlayers:{type:Boolean},showHeadingRow:{type:Boolean},showVolumeControl:{type:Boolean},allowWheel:{type:Boolean}},setup(e){const t=e,n=B([]),l=B([]),_=B(void 0),i=q(()=>t.player.group_members.length>0),c=function(d){const u=[];for(const a of d.group_members){const b=r?.players[a];b&&b.volume_control!=w&&b&&b.available&&!u.includes(b)&&u.push(b)}if(t.showSyncControls&&d.supported_features.includes(R.SET_MEMBERS))for(const a of Object.values(r?.players))a.player_id!=d.player_id&&(!d.can_group_with.includes(a.player_id)&&!d.can_group_with.includes(a.provider)||a.available&&a.type!=z.GROUP&&(a.active_group&&a.active_group!=d.player_id||a.active_source&&a.playback_state==M.PLAYING&&![d.player_id,a.player_id].includes(a.active_source)||u.includes(a)||u.push(a)));return u.sort((a,b)=>a.name.toUpperCase()>b.name.toUpperCase()?1:-1),u},y=async function(d,u){const a=t.player.player_id;u?(l.value.includes(d)&&(l.value=l.value.filter(b=>b!=d)),n.value.includes(d)||n.value.push(d),r.players[a].group_members.push(d)):(n.value.includes(d)&&(n.value=n.value.filter(b=>b!=d)),l.value.includes(d)||l.value.push(d),r.players[a].group_members=r.players[a].group_members.filter(b=>b!=d)),_.value!=null&&clearTimeout(_.value),!(n.value.length==0&&l.value.length==0)&&(_.value=setTimeout(async()=>{r.playerCommandSetMembers(a,n.value.length?n.value:void 0,l.value.length?l.value:void 0).catch(async()=>{r.players[a]=await r.getPlayer(a)}).finally(()=>{n.value=[],l.value=[]})},500))};return(d,u)=>(o(),g(X,{style:{overflow:"hidden",padding:"0"},lines:"two"},{default:m(()=>[e.showHeadingRow?(o(),g(A,{key:0,class:"volumesliderrow heading",link:!1,style:E(e.player.powered==!1?"opacity: 0.6":"opacity: 1")},{prepend:m(()=>[h(k,{size:25,icon:e.player.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:m(()=>[$("h5",null,v(s(I)(e.player,27)),1)]),append:m(()=>[e.player.power_control!=s(w)?(o(),g(T,{key:0,class:"powerbtn",variant:"icon",onClick:u[0]||(u[0]=C(a=>s(r).playerCommandPowerToggle(e.player.player_id),["stop"]))},{default:m(()=>[h(k,{size:25,icon:"mdi-power"})]),_:1})):f("",!0)]),_:1},8,["style"])):f("",!0),e.showVolumeControl&&(e.player.volume_control!=s(w)||e.player.group_members.length)?(o(),g(A,{key:1,class:"volumesliderrow",link:!1,style:E(e.player.powered==!1?"opacity: 0.35":"opacity: 0.75")},{prepend:m(()=>[h(T,{icon:"",style:{height:"25px"},disabled:e.player.type==s(z).GROUP||e.player.group_members.length>0||e.player.mute_control==s(w),onClick:u[1]||(u[1]=C(a=>s(r).playerCommandMuteToggle(e.player.player_id),["stop"]))},{default:m(()=>[h(k,{size:25,icon:e.player.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:1},8,["disabled"])]),default:m(()=>[e.player.volume_control!=s(w)||e.player.group_members.length?(o(),g(F,{key:0,color:"secondary",width:"100%","is-powered":e.player.powered!=!1,disabled:!e.player.available,"model-value":Math.round(e.player.group_members.length?e.player.group_volume:e.player.volume_level||0),onClick:u[2]||(u[2]=C(()=>{},["stop"])),"onUpdate:modelValue":u[3]||(u[3]=a=>e.player.group_members.length>0?s(r).playerCommandGroupVolume(e.player.player_id,a):s(r).playerCommandVolumeSet(e.player.player_id,a))},null,8,["is-powered","disabled","model-value"])):f("",!0)]),append:m(()=>[i.value&&!e.showSubPlayers?(o(),g(k,{key:0,class:"expandbtn"},{default:m(()=>[...u[7]||(u[7]=[P(" mdi-chevron-down ",-1)])]),_:1})):(o(),p("div",fe,v(Math.round(e.player.group_members.length?e.player.group_volume:e.player.volume_level||0)),1))]),_:1},8,["style"])):f("",!0),e.showSubPlayers&&(e.player.group_members.length>0||e.showSyncControls)&&c(e.player).length>0?(o(),p("div",{key:2,onClick:u[6]||(u[6]=C(()=>{},["stop"]))},[h(J,{style:{"margin-top":"10px","margin-bottom":"15px"}}),(o(!0),p(K,null,W(c(e.player),a=>(o(),p("div",{key:a.player_id},[h(A,{class:"volumesliderrow",link:!1,style:E(a.powered!=!1||e.showSyncControls?"opacity: 0.75":"opacity: 0.4"),onClick:u[4]||(u[4]=C(()=>{},["stop"]))},{prepend:m(()=>[h(k,{size:30,icon:a.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:m(()=>[$("h6",null,v(s(Z)(a.name,27)),1)]),append:m(()=>[e.showSyncControls?(o(),g(ye,{key:0,ripple:!1,disabled:a.player_id==e.player.player_id||e.player.static_group_members.includes(a.player_id)&&e.player.group_members.includes(a.player_id),"model-value":e.player.group_members.includes(a.player_id)||a.player_id==e.player.player_id,size:"22",class:"checkbox","onUpdate:modelValue":b=>y(a.player_id,b)},null,8,["disabled","model-value","onUpdate:modelValue"])):f("",!0)]),_:2},1032,["style"]),a.volume_control!=s(w)?(o(),g(A,{key:0,class:"volumesliderrow",link:!1,style:E(a.powered==!1?"opacity: 0.4":"opacity: 0.75"),onClick:u[5]||(u[5]=C(()=>{},["stop"]))},{prepend:m(()=>[h(T,{icon:"",disabled:!a.available||a.mute_control==s(w),style:{height:"25px"},onClick:b=>s(r).playerCommandMuteToggle(a.player_id)},{default:m(()=>[h(k,{size:25,icon:a.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:2},1032,["disabled","onClick"])]),default:m(()=>[a.volume_control!=s(w)?(o(),g(F,{key:0,color:"secondary",width:"100%","is-powered":a.powered!=!1,disabled:!a.available,"allow-wheel":e.allowWheel,"model-value":Math.round(a.volume_level||0),"onUpdate:modelValue":b=>s(r).playerCommandVolumeSet(a.player_id,b)},null,8,["is-powered","disabled","allow-wheel","model-value","onUpdate:modelValue"])):f("",!0)]),append:m(()=>[a.volume_control!=s(w)?(o(),p("div",ge,v(a.volume_level),1)):f("",!0)]),_:2},1032,["style"])):f("",!0),u[8]||(u[8]=$("div",{style:{height:"14px"}},null,-1))]))),128))])):f("",!0)]),_:1}))}}),_e=L(he,[["__scopeId","data-v-407df88f"]]),we=(e,t)=>{const n=[];e?.power_control!=w&&n.push({label:e.powered?"power_off_player":"power_on_player",labelArgs:[],action:()=>{r.playerCommandPowerToggle(e.player_id)},icon:"mdi-power"}),(e?.playback_state=="playing"||e?.playback_state=="paused")&&n.push({label:"stop_playback",labelArgs:[],action:()=>{r.playerCommandStop(e.player_id)},icon:"mdi-stop"});const l=Object.values(r.players).filter(i=>i.player_id!=e.player_id&&i.available&&i.enabled&&(i.can_group_with.includes(e.provider)||i.can_group_with.includes(e.player_id))&&i.supported_features.includes(R.SET_MEMBERS)&&!i.synced_to);e.supported_features.includes(R.SET_MEMBERS)&&!e.synced_to&&e.type==z.PLAYER&&e.group_members.length==0&&l.length>0&&n.push({label:"sync_player_with",labelArgs:[],icon:"mdi-link-variant",subItems:l.map(i=>({label:i.name,labelArgs:[],action:()=>{r.playerCommandGroup(e.player_id,i.player_id)}})).sort((i,c)=>i.label.toUpperCase()>c.label?.toUpperCase()?1:-1)}),t&&n.push({label:t.shuffle_enabled?"shuffle_disable":"shuffle_enable",labelArgs:[],action:()=>{r.queueCommandShuffleToggle(t.queue_id)},icon:t.shuffle_enabled?"mdi-shuffle-disabled":"mdi-shuffle"}),t&&n.push({label:"select_repeat_mode",labelArgs:[],subItems:[{label:"repeat_mode.off",labelArgs:[],action:()=>{r.queueCommandRepeat(t.queue_id,V.OFF)},selected:t.repeat_mode==V.OFF},{label:"repeat_mode.all",labelArgs:[],action:()=>{r.queueCommandRepeat(t.queue_id,V.ALL)},selected:t.repeat_mode==V.ALL},{label:"repeat_mode.one",labelArgs:[],action:()=>{r.queueCommandRepeat(t.queue_id,V.ONE)},selected:t.repeat_mode==V.ONE}],icon:"mdi-repeat"}),t?.items&&n.push({label:"transfer_queue",icon:"mdi-swap-horizontal",subItems:Object.values(r.players).filter(i=>i.player_id!=t.queue_id&&i.player_id!=e.player_id&&i.available&&i.enabled&&!i.synced_to).map(i=>({label:i.name,labelArgs:[],action:()=>{r.queueCommandTransfer(t.queue_id,i.player_id),S.activePlayerId=i.player_id}})).sort((i,c)=>i.label.toUpperCase()>c.label?.toUpperCase()?1:-1)}),t?.items&&n.push({label:"queue_clear",labelArgs:[],action:()=>{r.queueCommandClear(t.queue_id)},icon:"mdi-cancel"});const _=e.source_list.filter(i=>!i.passive||i.id==e.active_source);return e.active_source!=e.player_id&&_.push({id:e.player_id,name:Q("music_assistant_source"),passive:!1,can_play_pause:!0,can_seek:!0,can_next_previous:!0}),!e.synced_to&&_.length>0&&n.push({label:"select_source",labelArgs:[],icon:"mdi-import",subItems:_.map(i=>({label:i.name,labelArgs:[],disabled:i.id==e.active_source,selected:i.id==e.active_source,action:()=>{r.playerCommandGroupSelectSource(e.player_id,i.id)}})).sort((i,c)=>i.label.toUpperCase()>c.label?.toUpperCase()?1:-1)}),t&&"dont_stop_the_music_enabled"in t&&n.push({label:t.dont_stop_the_music_enabled?"dont_stop_the_music_disable":"dont_stop_the_music_enable",labelArgs:[],action:()=>{r.queueCommandDontStopTheMusicToggle(t.queue_id)},icon:"mdi-all-inclusive"}),n.push({label:"open_player_settings",labelArgs:[],action:()=>{S.showFullscreenPlayer=!1,S.showPlayersMenu=!1,x.push(`/settings/editplayer/${e.player_id}`)},icon:"mdi-cog-outline"}),e.type!==z.GROUP&&n.push({label:"open_dsp_settings",labelArgs:[],action:()=>{S.showFullscreenPlayer=!1,S.showPlayersMenu=!1,x.push(`/settings/editplayer/${e.player_id}/dsp`)},icon:"mdi-equalizer"}),n},ke={class:"player-media-thumb"},Ce={key:1},Se={key:2,class:"icon-thumb"},Ve={key:0,style:{"margin-bottom":"3px"}},Te={key:0},Ae={key:1},Me={key:1},Be={key:0,style:{"font-size":"0.85rem","font-weight":"500","white-space":"nowrap"}},$e={key:0},qe={key:0},ze={key:1},Ee={key:2},Pe={class:"v-list-item-subtitle",style:{"font-size":"0.85rem","white-space":"nowrap"}},Ue={key:0},Ie={key:1},Re={key:2},Le={key:3},xe={key:4},Ne={key:5},Oe={key:6},De={key:7},Fe=G({__name:"PlayerCard",props:{player:{},showVolumeControl:{type:Boolean},showMenuButton:{type:Boolean},showSubPlayers:{type:Boolean},showSyncControls:{type:Boolean},allowPowerControl:{type:Boolean}},emits:["click"],setup(e){const t=e,n=q(()=>{if(t.player&&t.player.active_source&&t.player.active_source in r.queues)return r.queues[t.player.active_source];if(t.player&&!t.player.active_source&&t.player.player_id in r.queues)return r.queues[t.player.player_id]}),l=q(()=>{if(n.value&&n.value.active)return n.value.current_item}),_=function(y){me.emit("contextmenu",{items:we(t.player,n.value),posX:y.clientX,posY:y.clientY})},i=B({0:"",1:"",2:"",3:"",4:"",5:"",lightColor:"",darkColor:""}),c=new Image;return c.src=ae.theme.current.value.dark?N:ee,c.crossOrigin="Anonymous",c.addEventListener("load",function(){i.value=le(c)}),te(l,y=>{y?.media_item?c.src=O(y.media_item,D.THUMB)||"":y?c.src=O(y,D.THUMB)||"":c.src=""},{immediate:!0}),(y,d)=>(o(),g(ie,{flat:"",class:oe(["panel-item",{"panel-item-selected":e.player.player_id==s(S).activePlayerId,"panel-item-idle":e.player.playback_state==s(M).IDLE,"panel-item-off":e.player.powered==!1}]),ripple:!1,disabled:!e.player.available,onClick:d[2]||(d[2]=u=>y.$emit("click",e.player))},{default:m(()=>[h(A,{class:"panel-item-details",flat:"",ripple:!1},{prepend:m(()=>[$("div",ke,[e.player.powered!=!1&&l.value?(o(),g(ce,{key:0,class:"media-thumb",size:"60",item:l.value,fallback:s(N)},null,8,["item","fallback"])):e.player.powered!=!1&&!n.value&&e.player.current_media?.image_url?(o(),p("div",Ce,[h(ue,{class:"media-thumb",size:"60",src:e.player.current_media.image_url},null,8,["src"])])):(o(),p("div",Se,[h(k,{size:"24",icon:e.player.type==s(z).PLAYER&&e.player.group_members.length?"mdi-speaker-multiple":e.player.icon,style:{display:"table-cell",opacity:"0.8"}},null,8,["icon"])]))])]),title:m(()=>[s(de).player_id===e.player.player_id?(o(),p("div",Ve,[e.player.name=="This Device"?(o(),p("span",Te,v(y.$t("this_device")),1)):(o(),p("span",Ae,v(s(I)(e.player,27)),1)),h(k,{size:"20",class:"ml-2",icon:s(S).deviceType=="phone"?"mdi-cellphone":"mdi-monitor"},null,8,["icon"])])):(o(),p("div",Me,v(s(I)(e.player,27)),1))]),subtitle:m(()=>[e.player.powered!=!1?(o(),p("div",Be,[l.value?.media_item?(o(),p("div",$e,[P(v(l.value?.media_item.name)+" ",1),"version"in l.value?.media_item&&l.value?.media_item.version?(o(),p("span",qe,"("+v(l.value?.media_item.version)+")",1)):f("",!0)])):l.value?(o(),p("div",ze,v(l.value?.name),1)):!n.value&&e.player.current_media?.title?(o(),p("div",Ee,v(e.player.current_media.title),1)):f("",!0)])):f("",!0)]),default:m(()=>[$("div",Pe,[e.player.powered==!1?(o(),p("div",Ue,v(y.$t("off")),1)):l.value?.media_item&&l.value?.media_item?.media_type==s(se).TRACK&&"album"in l.value?.media_item&&l.value?.media_item.album?(o(),p("div",Ie,v(s(ne)(l.value?.media_item.artists))+" • "+v(l.value?.media_item.album.name),1)):l.value?.media_item&&"artists"in l.value?.media_item&&l.value?.media_item.artists.length>0?(o(),p("div",Re,v(l.value?.media_item.artists[0].name),1)):l.value?.streamdetails?.stream_metadata&&l.value?.streamdetails?.stream_metadata.title&&l.value?.streamdetails?.stream_metadata.artist?(o(),p("div",Le,v(l.value?.streamdetails?.stream_metadata.artist)+" - "+v(l.value?.streamdetails?.stream_metadata.title),1)):l.value?.streamdetails?.stream_metadata&&l.value?.streamdetails?.stream_metadata.title?(o(),p("div",xe,v(l.value?.streamdetails?.stream_metadata.title),1)):l.value?.media_item?.metadata.description?(o(),p("div",Ne,v(l.value?.media_item.metadata.description),1)):!n.value&&e.player.active_source?(o(),p("div",Oe,v(y.$t("external_source_active",[s(re)(e.player)])),1)):n.value?.items==0?(o(),p("div",De,v(y.$t("queue_empty")),1)):f("",!0)])]),append:m(()=>[e.player.playback_state==s(M).PAUSED||e.player.playback_state==s(M).PLAYING||n.value?.items?(o(),g(T,{key:0,variant:"icon",class:"player-command-btn",onClick:d[0]||(d[0]=C(u=>{s(r).playerCommandPlayPause(e.player.player_id),s(S).activePlayerId=e.player.player_id},["stop"]))},{default:m(()=>[h(k,{size:s(U)({breakpoint:"phone"})?"30":"32",icon:e.player.playback_state==s(M).PLAYING?"mdi-pause":"mdi-play"},null,8,["size","icon"])]),_:1})):f("",!0),e.player.power_control!=s(w)&&e.allowPowerControl?(o(),g(T,{key:1,variant:"icon",class:"player-command-btn",onClick:d[1]||(d[1]=C(u=>{s(r).playerCommandPowerToggle(e.player.player_id),s(S).activePlayerId=e.player.player_id},["stop"]))},{default:m(()=>[h(k,{size:s(U)({breakpoint:"phone"})?"30":"32"},{default:m(()=>[...d[3]||(d[3]=[P("mdi-power",-1)])]),_:1},8,["size"])]),_:1})):f("",!0),e.showMenuButton?(o(),g(T,{key:2,variant:"icon",class:"player-command-btn",style:{"margin-right":"-5px"},onClick:C(_,["stop"])},{default:m(()=>[h(k,{size:s(U)({breakpoint:"phone"})?"30":"32"},{default:m(()=>[...d[4]||(d[4]=[P("mdi-dots-vertical",-1)])]),_:1},8,["size"])]),_:1})):f("",!0)]),_:1}),e.showVolumeControl?(o(),g(_e,{key:0,player:e.player,"show-sync-controls":e.showSyncControls,"show-heading-row":!1,"show-sub-players":e.showSubPlayers,"show-volume-control":e.player.powered!=!1,"allow-wheel":!1},null,8,["player","show-sync-controls","show-sub-players","show-volume-control"])):f("",!0)]),_:1},8,["class","disabled"]))}}),Je=L(Fe,[["__scopeId","data-v-f0fdac10"]]);export{F as P,_e as V,Je as a,we as g};
