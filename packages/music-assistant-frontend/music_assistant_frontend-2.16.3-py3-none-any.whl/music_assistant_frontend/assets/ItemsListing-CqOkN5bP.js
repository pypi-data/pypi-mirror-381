import{C as _e}from"./Container-BVutxj42.js";import{T as et}from"./Toolbar-RSDUeNZR.js";import{x as Ae,y as tt,O as at,a2 as it,b,D as $e,E as P,R as lt,G as st,a5 as ot,I as nt,an as ut,ai as rt,d as q,e as m,o as n,aA as ue,u as y,b0 as M,m as se,bw as Ce,i as $,N as H,bO as K,w as c,q as f,c as p,aF as ct,bN as Te,bG as oe,b4 as I,t as v,J as U,v as mt,M as C,g as O,a as R,aX as dt,bd as j,bP as ft,be as vt,bQ as Fe,bH as xe,bR as re,bS as Ve,bK as De,ae as yt,n as ht,bl as bt,V as pt,f as kt,by as Y,s as S,bC as wt,bz as gt,ar as It,l as ie,ad as X,j as St,ao as be,bT as Bt,k as pe,a_ as z,p as At,aR as $t,bt as Ct,F as ke,r as we,bu as ge,bv as le,bJ as Tt}from"./index-BLuBzgcR.js";import{B as Pe}from"./Button-BEhYIX-0.js";import{L as Ft}from"./ListItem-D3UfOTqB.js";import{_ as ne,V as Oe}from"./NowPlayingBadge.vue_vue_type_style_index_0_lang-Dwz4QKKd.js";import{M as Le}from"./MediaItemThumb-4FqrTjbr.js";import{a as W}from"./VBtn-i8gedOhv.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as xt,P as Vt}from"./PanelviewItemCompact-Czo8xJLH.js";import{V as Dt}from"./VSpacer-FdmIBMIx.js";import{V as Pt}from"./VTextField-BRzkPyuL.js";import{a as Ot,V as Lt}from"./VInfiniteScroll-XtiIpwbc.js";import{V as Ie,a as Se}from"./VRow-Dw7kUaJt.js";import{V as Et}from"./VVirtualScroll-JP5E3DQw.js";import{V as Be}from"./VAlert-Du-laR0E.js";const Ee=Symbol.for("vuetify:v-item-group"),Mt=tt({...nt(),...ot({selectedClass:"v-item--selected"}),...st(),...lt()},"VItemGroup"),Me=Ae()({name:"VItemGroup",props:Mt(),emits:{"update:modelValue":e=>!0},setup(e,i){let{slots:w}=i;const{themeClasses:g}=at(e),{isSelected:l,select:k,next:B,prev:T,selected:u}=it(e,Ee);return()=>b(e.tag,{class:P(["v-item-group",g.value,e.class]),style:$e(e.style)},{default:()=>[w.default?.({isSelected:l,select:k,next:B,prev:T,selected:u.value})]})}}),L=Ae()({name:"VItem",props:ut(),emits:{"group:selected":e=>!0},setup(e,i){let{slots:w}=i;const{isSelected:g,select:l,toggle:k,selectedClass:B,value:T,disabled:u}=rt(e,Ee);return()=>w.default?.({isSelected:g.value,selectedClass:B.value,select:l,toggle:k,value:T.value,disabled:u.value})}}),Re=q({__name:"FavoriteButton",props:{item:{}},setup(e){const i=e;return(w,g)=>(n(),m(Pe,ue(i,{variant:"icon",icon:e.item?.favorite?"mdi-heart":"mdi-heart-outline",title:w.$t("tooltip.favorite"),onClick:[g[0]||(g[0]=l=>y(se).toggleFavorite(e.item)),g[1]||(g[1]=M(()=>{},["prevent"])),g[2]||(g[2]=M(()=>{},["stop"]))]}),null,16,["icon","title"]))}}),Rt={key:0,class:"media-thumb listitem-media-thumb"},Kt={key:1,class:"media-thumb listitem-media-thumb"},Nt={key:0},Yt={key:0},zt={key:0,class:"line-clamp-1"},Gt={key:1},Xt={key:0},Ht={key:1},Ut={key:2},jt={key:3},Wt={key:4},qt={key:5},Jt={key:6},Qt={key:7},Zt={key:5},_t={key:6},ea={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},ta=q({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(e,{emit:i}){const{t:w}=Ce(),g=$(!1),l=e,k=H(()=>{if(!("provider_mappings"in l.item))return"";for(const d of l.item.provider_mappings)if(d.audio_format&&d.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(d.audio_format.content_type)&&(d.audio_format.sample_rate>48e3||d.audio_format.bit_depth>16))return`${d.audio_format.sample_rate/1e3}kHz ${d.audio_format.bit_depth} bits`;return""}),B=i,T=function(d){const h=d;re(l.item,h.clientX,h.clientY,l.parentItem)},u=function(d){if(l.showCheckboxes)return;const h=d;Ve(l.item,h.clientX,h.clientY,l.parentItem)},F=function(d){l.showCheckboxes||De(l.item,d.clientX,d.clientY,l.parentItem)};return(d,h)=>(n(),m(Ft,{link:"","show-menu-btn":e.showMenu,class:P({unavailable:!e.isAvailable}),onClick:M(u,["stop"]),onMenu:M(T,["stop"])},{prepend:c(()=>[e.showCheckboxes?(n(),p("div",Rt,[b(Oe,{"model-value":e.isSelected,onClick:h[0]||(h[0]=M(()=>{},["stop"])),"onUpdate:modelValue":h[1]||(h[1]=A=>{A!=null&&B("select",e.item,A)})},null,8,["model-value"])])):(n(),p("div",Kt,[b(Le,{size:"50",item:e.isAvailable?e.item:void 0,class:P({dimmed:g.value})},null,8,["item","class"])])),!e.showCheckboxes&&e.item.is_playable?(n(),m(W,{key:2,class:P({hidden:!g.value}),icon:"mdi-play",variant:"text",size:"small",style:{position:"absolute",left:"14px",bottom:"12px",color:"white","font-size":"18px"},onClick:M(F,["stop"]),onMouseenter:h[2]||(h[2]=A=>g.value=!0),onMouseleave:h[3]||(h[3]=A=>g.value=!1)},null,8,["class"])):f("",!0)]),title:c(()=>[e.item.media_type==y(C).FOLDER?(n(),p("span",Nt,[R("span",null,v(y(Fe)(e.item,y(w))),1)])):(n(),p("span",{key:1,class:P({"is-playing":e.isPlaying})},[I(v(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),p("span",Yt,"("+v(e.item.version)+")",1)):f("",!0)],2)),e.item&&e.item.metadata?(n(),m(y(oe),{key:2,location:"bottom"},{activator:c(({props:A})=>[y(xe)(e.item.metadata.explicit||!1)?(n(),m(O,ue({key:0},A,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):f("",!0)]),default:c(()=>[R("span",null,v(d.$t("tooltip.explicit")),1)]),_:1})):f("",!0)]),subtitle:c(()=>[e.item.media_type==y(C).TRACK&&"provider_mappings"in e.item?(n(),p("div",zt,[b(Me,null,{default:c(()=>["artists"in e.item?(n(),m(L,{key:0},{default:c(()=>[I(v(y(j)(e.item.artists,2)),1)]),_:1})):f("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),m(L,{key:1},{default:c(()=>[I(" • "+v(e.item.album.name),1)]),_:1})):f("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(n(),m(L,{key:2},{default:c(()=>[b(O,{style:{"margin-left":"5px"},icon:"md:album"}),I(" "+v(e.item.disc_number),1)]),_:1})):f("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),m(L,{key:3},{default:c(()=>[b(O,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),I(" "+v(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(n(),m(L,{key:4},{default:c(()=>[b(O,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),I(" "+v(e.item.position),1)]),_:1})):f("",!0)]),_:1})])):e.item.media_type==y(C).ALBUM&&"year"in e.item?(n(),p("div",Gt,[e.item.album_type!=y(ft).UNKNOWN?(n(),p("span",Xt,v(d.$t("album_type."+e.item.album_type))+" • ",1)):f("",!0),R("span",null,v(y(j)(e.item.artists)),1),e.item.year?(n(),p("span",Ht," • "+v(e.item.year),1)):f("",!0)])):"artists"in e.item&&e.item.artists?(n(),p("div",Ut,v(y(j)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),p("div",jt,v(e.item.owner),1)):"authors"in e.item&&e.item.authors?(n(),p("div",Wt,v(e.item.authors.join(" / ")),1)):"publisher"in e.item&&e.item.publisher?(n(),p("div",qt,v(e.item.publisher),1)):"metadata"in e.item&&e.item.metadata?.description&&[y(C).RADIO,y(C).PLAYLIST,y(C).FOLDER].includes(e.item.media_type)?(n(),p("div",Jt,v(y(vt)(e.item.metadata.description,150)),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),p("div",Qt,v(d.$t(e.item.media_type)),1)):f("",!0)]),append:c(()=>[e.isPlaying?(n(),m(ne,{key:0})):f("",!0),k.value?(n(),m(ct,{key:1,src:y(Te),width:"30",class:P(d.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:c(()=>[b(y(oe),{activator:"parent",location:"bottom"},{default:c(()=>[I(v(k.value),1)]),_:1})]),_:1},8,["src","class"])):f("",!0),y(U)("bp2")&&e.showProvider?(n(),m(mt,{key:2,domain:e.item.media_type==y(C).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):f("",!0),"fully_played"in e.item&&e.item.fully_played?(n(),m(O,{key:3,title:d.$t("item_fully_played")},{default:c(()=>[...h[4]||(h[4]=[I("mdi-check",-1)])]),_:1},8,["title"])):"resume_position_ms"in e.item&&e.item.resume_position_ms?(n(),m(O,{key:4,title:d.$t("item_in_progress")},{default:c(()=>[...h[5]||(h[5]=[I("mdi-clock-fast",-1)])]),_:1},8,["title"])):f("",!0),y(U)("bp3")&&"favorite"in e.item&&e.showFavorite&&!d.$vuetify.display.mobile?(n(),p("div",Zt,[b(Re,{item:e.item},null,8,["item"])])):f("",!0),e.showDuration&&"duration"in e.item&&e.item.duration&&y(U)("bp0")?(n(),p("div",_t,[R("div",null,[R("span",ea,v(y(dt)(e.item.duration)),1)])])):f("",!0)]),_:1},8,["show-menu-btn","class"]))}}),aa=ce(ta,[["__scopeId","data-v-9ae0d4eb"]]),ia={key:0},la=["src"],sa={key:0},oa=q({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},showTrackNumber:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},isPlaying:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(e,{emit:i}){const w=e,g=H(()=>{for(const u of w.item.provider_mappings)if(u.audio_format&&u.audio_format.content_type!=null&&[K.DSF,K.FLAC,K.AIFF,K.WAV].includes(u.audio_format.content_type)&&(u.audio_format.sample_rate>48e3||u.audio_format.bit_depth>16))return`${u.audio_format.sample_rate/1e3}kHz ${u.audio_format.bit_depth} bits`;return""}),l=i,k=function(u){if(w.showCheckboxes)return;const F="clientX"in u?u.clientX:u.touches[0].clientX,d="clientY"in u?u.clientY:u.touches[0].clientY;re(w.item,F,d,w.parentItem)},B=function(u){if(w.showCheckboxes){l("select",w.item,!w.isSelected);return}Ve(w.item,u.clientX,u.clientY,w.parentItem)},T=function(u){w.showCheckboxes||De(w.item,u.clientX,u.clientY,w.parentItem)};return(u,F)=>{const d=gt("hold");return n(),m(xt,null,{default:c(({isHovering:h,props:A})=>[yt((n(),m(ht,ue(A,{tile:"",hover:"",class:["panel-item",{unavailable:!e.isAvailable}],onClick:B,onContextmenu:M(k,["right","prevent"])}),{default:c(()=>[e.showCheckboxes?(n(),m(bt,{key:0,"model-value":e.showCheckboxes,contained:"",scrim:e.isSelected?u.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:c(()=>[b(Oe,{class:"panel-item-checkbox",ripple:!1,"model-value":e.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):f("",!0),b(Le,{item:e.isAvailable?e.item:void 0,style:{height:"auto"}},null,8,["item"]),b(pt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:c(()=>[b(kt,null,{default:c(()=>[e.item.media_type==y(C).FOLDER?(n(),p("span",ia,[R("span",null,v(y(Fe)(e.item,u.$t)),1)])):(n(),p("span",{key:1,class:P({"is-playing":e.isPlaying})},v(e.item.name),3)),"version"in e.item&&e.item.version?(n(),p("span",{key:2,class:P({"is-playing":e.isPlaying})}," - "+v(e.item.version),3)):f("",!0)]),_:1}),"artists"in e.item&&e.item.artists?(n(),m(Y,{key:0,class:"line-clamp-1"},{default:c(()=>[I(v(y(j)(e.item.artists,1)),1)]),_:1})):f("",!0),"authors"in e.item&&e.item.authors?(n(),m(Y,{key:1,class:"line-clamp-1"},{default:c(()=>[I(v(e.item.authors.join(" / ")),1)]),_:1})):"publisher"in e.item&&e.item.publisher?(n(),m(Y,{key:2,class:"line-clamp-1"},{default:c(()=>[I(v(e.item.publisher),1)]),_:1})):"owner"in e.item&&e.item.owner?(n(),m(Y,{key:3,class:"line-clamp-1"},{default:c(()=>[I(v(e.item.owner),1)]),_:1})):e.showMediaType?(n(),m(Y,{key:4,class:"line-clamp-1"},{default:c(()=>[I(v(u.$t(e.item.media_type)),1)]),_:1})):(n(),m(Y,{key:5,class:"line-clamp-1"}))]),_:1}),e.isPlaying&&!e.showActions?(n(),m(ne,{key:1,"icon-style":"position: absolute; right: 5px; bottom: 5px","show-badge":!1})):f("",!0),(h||y(S).isTouchscreen)&&e.isAvailable&&e.item.is_playable?(n(),m(W,{key:2,icon:"mdi-play",color:"primary",fab:"",style:$e(`position: absolute; right: 15px; bottom: ${e.showActions?90:35}px; opacity: 0.8`),onClick:M(T,["stop"])},null,8,["style"])):f("",!0),e.showActions?(n(),m(wt,{key:3,class:"panel-item-actions"},{default:c(()=>[b(Me,{style:{padding:"0"}},{default:c(()=>[y(xe)(e.item.metadata.explicit||!1)?(n(),m(L,{key:0},{default:c(()=>[b(O,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):f("",!0),g.value?(n(),m(L,{key:1},{default:c(()=>[b(O,{class:P(u.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:c(()=>[R("img",{src:y(Te),width:"30"},null,8,la),b(oe,{activator:"parent",location:"bottom"},{default:c(()=>[I(v(g.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):f("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),m(L,{key:2},{default:c(()=>[b(O,{size:"small",icon:"mdi-music-circle-outline"}),e.item.disc_number?(n(),p("span",sa,v(e.item.disc_number)+"/",1)):f("",!0),I(v(e.item.track_number),1)]),_:1})):"position"in e.item&&e.item.position?(n(),m(L,{key:3},{default:c(()=>[b(O,{size:"small",icon:"mdi-music-circle-outline"}),I(" "+v(e.item.position),1)]),_:1})):f("",!0),y(U)("bp3")?(n(),m(L,{key:4},{default:c(()=>[b(Re,{item:e.item},null,8,["item"])]),_:1})):f("",!0)]),_:1}),e.isPlaying?(n(),m(ne,{key:0,"show-badge":!1})):f("",!0),b(Dt),h||u.$vuetify.display.mobile?(n(),m(Pe,{key:1,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:M(k,["stop"])})):f("",!0)]),_:2},1024)):f("",!0)]),_:2},1040,["class"])),[[d,k]])]),_:1})}}}),na=ce(oa,[["__scopeId","data-v-bb3ba95c"]]),ua={key:0},ra={key:2},ca=q({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(se.providers).length>1},showAlbum:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1},onTitleClick:{type:Function,default:void 0}},setup(e){const i=e,w=Tt(),{t:g}=Ce(),l=$({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),k=$("list"),B=$(!1),T=$(!1),u=$([]),F=$([]),d=$(!1),h=$([]),A=$(!1),V=$(!1),N=$(!0),E=$(!1),G=$(!1),J=$(!1),me=function(){l.value.search="",B.value=!1},Q=function(){be(()=>{document.getElementById("searchInput")?.focus()})},Ke=function(){B.value?me():(B.value=!0,Q())},Z=function(){if(i.onTitleClick){i.onTitleClick();return}N.value=!N.value;const t=`${i.path}.${i.itemtype}`;localStorage.setItem(`expand.${t}`,N.value.toString())},_=function(t){k.value=t;const s=`${i.path}.${i.itemtype}`;localStorage.setItem(`viewMode.${s}`,t)},Ne=function(){l.value.favoritesOnly=!l.value.favoritesOnly;const t=l.value.favoritesOnly?"true":"false",s=`${i.path}.${i.itemtype}`;localStorage.setItem(`favoriteFilter.${s}`,t),D(void 0,void 0,!0)},Ye=function(){l.value.libraryOnly=!l.value.libraryOnly;const t=l.value.libraryOnly?"true":"false",s=`${i.path}.${i.itemtype}`;localStorage.setItem(`libraryFilter.${s}`,t),D(!0,void 0,!0)},ze=function(){l.value.albumArtistsFilter=!l.value.albumArtistsFilter;const t=l.value.albumArtistsFilter?"true":"false",s=`${i.path}.${i.itemtype}`;localStorage.setItem(`albumArtistsFilter.${s}`,t),D(void 0,void 0,!0)},ee=function(t){return h.value.includes(t)},te=function(t,s){const a=S.curQueueItem?.media_item;if(!a)return!1;switch(s){case"tracks":return t.item_id===a.item_id;case"albums":return"album"in a?t.item_id===a.album.item_id:!1;case"artists":return"artists"in a?Array.isArray(a.artists)&&a.artists.some(o=>o.item_id===t.item_id):!1;case"radios":return t.item_id===a.item_id;case"podcasts":return"podcast"in a?t.item_id===a.podcast.item_id:!1;case"podcastepisodes":return t.item_id===a.item_id;default:return!1}},ae=function(t,s){if(s)h.value.includes(t)||h.value.push(t);else for(let a=0;a<h.value.length;a++)h.value[a]===t&&h.value.splice(a,1)},Ge=function(){V.value&&(h.value=[]),V.value=!V.value},Xe=function(){D(!0,!0)},He=function(){l.value.search="",B.value=!1,D(void 0,void 0,!0)},Ue=function(t){t!==void 0&&(l.value.sortBy=t);const s=`${i.path}.${i.itemtype}`;localStorage.setItem(`sortBy.${s}`,l.value.sortBy),D(void 0,void 0,!0)},je=function(t){l.value.albumType?.includes(t)?l.value.albumType=l.value.albumType?.filter(a=>a!==t):(l.value.albumType=l.value.albumType||[],l.value.albumType.push(t));const s=`${i.path}.${i.itemtype}`;localStorage.setItem(`albumType.${s}`,l.value.albumType.join(",")),D(void 0,void 0,!0)},We=function(){S.globalSearchTerm=l.value.search,i.itemtype=="artists"?S.globalSearchType=C.ARTIST:i.itemtype=="albums"?S.globalSearchType=C.ALBUM:i.itemtype=="tracks"?S.globalSearchType=C.TRACK:i.itemtype=="playlists"?S.globalSearchType=C.PLAYLIST:i.itemtype=="audiobooks"?S.globalSearchType=C.AUDIOBOOK:i.itemtype=="podcasts"?S.globalSearchType=C.PODCAST:i.itemtype=="radios"&&(S.globalSearchType=C.RADIO),w.push({name:"search"})},de=async function({done:t}){if(E.value){t("empty");return}await D(void 0,void 0,void 0,l.value.offset+i.limit),t("ok")},qe=async function(){for(;!E.value;)await de({done:function(){}})},fe=H(()=>{var t=!1;return l.value.search&&l.value.search.length!==0&&(t=!0),t}),ve=H(()=>B.value&&N.value);It(()=>{ve.value||(T.value=!1)});const Je=H(()=>{if(i.allowCollapse===!0&&!N.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:Z,overflowAllowed:!1}];const t=[];return i.showSelectButton!==!1&&(V.value&&t.push({label:"tooltip.select_all",icon:"mdi-select-all",action:he}),t.push({label:"tooltip.select_items",icon:V.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:Ge,active:V.value})),i.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Ye,active:l.value.libraryOnly}),i.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:l.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:Ne,active:l.value.favoritesOnly}),i.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:l.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:ze,active:l.value.albumArtistsFilter}),i.showAlbumTypeFilter&&t.push({label:"tooltip.album_type",icon:"mdi-album",disabled:d.value,subItems:["album","single","ep","compilation","live","soundtrack","unknown"].map(s=>({label:`album_type.${s}`,selected:l.value.albumType?.includes(s),action:()=>{je(s)}}))}),(i.showRefreshButton!==!1||A.value)&&t.push({label:A.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:Xe,active:A.value,disabled:d.value}),i.sortKeys?.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:i.sortKeys.length<=1||d.value,subItems:i.sortKeys.map(s=>({label:`sort.${s}`,selected:l.value.sortBy==s,action:()=>{Ue(s)}}))}),i.showSearchButton!==!1&&t.push({label:fe.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Ke,active:fe.value,disabled:d.value}),t.push({label:"tooltip.toggle_view_mode",icon:k.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:k.value=="list",action:()=>{_("list")}},{label:"view.panel",icon:"mdi-grid",selected:k.value=="panel",action:()=>{_("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:k.value=="panel_compact",action:()=>{_("panel_compact")}}]}),i.extraMenuItems?.length&&t.push(...i.extraMenuItems),i.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:Z}),t}),D=async function(t=!1,s=!1,a=!1,o=0){if(!d.value){if(d.value=!0,a&&i.loadPagedData!=null&&(t=!0),(t||s)&&(o=0,E.value&&(J.value=!0),E.value=!1,G.value=!1,A.value=!1),l.value.offset=o,l.value.limit=i.limit,l.value.refresh=s,i.loadPagedData!=null){const r=await i.loadPagedData(l.value);l.value.offset?u.value.push(...r):u.value=r,Math.abs(r.length-i.limit)>10&&(E.value=!0)}else if(i.loadItems!=null){(!G.value||s)&&(F.value=await i.loadItems(l.value),G.value=!0);const r=Ze(F.value,l.value);l.value.offset?u.value.push(...r):u.value=r,E.value=r.length<i.limit}l.value.refresh=!1,d.value=!1,J.value=!1}},Qe=async function(){const t=`${i.path}.${i.itemtype}`,s=localStorage.getItem(`viewMode.${t}`);s&&s!=="null"?k.value=s:i.itemtype=="artists"||i.itemtype=="albums"?k.value="panel":k.value="list";const a=localStorage.getItem(`sortBy.${t}`);if(a&&a!=="null"&&i.sortKeys.includes(a)?l.value.sortBy=a:l.value.sortBy=i.sortKeys[0],i.showFavoritesOnlyFilter!==!1){const o=localStorage.getItem(`favoriteFilter.${t}`);o&&o=="true"&&(l.value.favoritesOnly=!0)}if(i.showLibraryOnlyFilter!==!1){const o=localStorage.getItem(`libraryFilter.${t}`);o&&o=="true"&&(l.value.libraryOnly=!0)}if(i.showAlbumArtistsOnlyFilter!==!1){const o=localStorage.getItem(`albumArtistsFilter.${t}`);o&&(l.value.albumArtistsFilter=o=="true")}if(i.allowCollapse!==!1){const o=localStorage.getItem(`expand.${t}`);o&&(N.value=o=="true")}if(i.showAlbumTypeFilter===!0){const o=localStorage.getItem(`albumType.${t}`);o&&(l.value.albumType=o.split(","))}if(i.restoreState){let o=`search.${t}`;i.parentItem&&(o+=i.parentItem.item_id);const r=localStorage.getItem(o);r&&r!=="null"&&(l.value.search=r)}},ye=function(t){S.dialogActive||d.value||(t.key==="Escape"&&me(),!T.value&&(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),he()):!T.value&&t.key=="Backspace"?Q():!T.value&&t.key.length==1&&(B.value=!0,Q())))};i.allowKeyHooks&&(document.addEventListener("keydown",ye),ie(()=>{document.removeEventListener("keydown",ye)})),i.restoreState&&ie(()=>{const t=i.path||i.itemtype,s=document.querySelector("#cont");S.prevState={path:t,scrollPos:s?.scrollTop||0,pagedItems:u.value,allItems:F.value,allItemsReceived:E.value,initialDataReceived:G.value,params:l.value}}),X(()=>l.value.search,t=>{t&&(B.value=!0),D(void 0,void 0,!0);let s=`search.${i.path}.${i.itemtype}`;i.parentItem&&(s+=i.parentItem.item_id),localStorage.setItem(s,l.value.search)}),X(()=>i.path,t=>{d.value!=!0&&(u.value=[],F.value=[],D(!0))}),X(()=>i.parentItem,()=>{d.value!=!0&&(F.value=[],A.value=!0)},{deep:!0}),X(()=>i.limit,t=>{l.value.limit=t}),X(()=>i.updateAvailable,t=>{d.value||(A.value=t)},{immediate:!0}),St(async()=>{Qe();const t=i.path||i.itemtype;i.restoreState&&S.prevState?.path==t?(l.value=S.prevState.params,u.value=S.prevState.pagedItems,F.value=S.prevState.allItems,E.value=S.prevState.allItemsReceived,G.value=S.prevState.initialDataReceived,be(()=>{const a=document.getElementById("cont");a&&Bt(a,S.prevState.scrollPos,50)}),d.value=!1):D(!0),pe.on("clearSelection",()=>{h.value=[],V.value=!1});const s=se.subscribe_multi([z.MEDIA_ITEM_UPDATED,z.MEDIA_ITEM_DELETED,z.MEDIA_ITEM_PLAYED],a=>{if(a.event==z.MEDIA_ITEM_DELETED)u.value=u.value.filter(o=>o.uri!=a.object_id);else if(a.event==z.MEDIA_ITEM_UPDATED){const o=u.value.findIndex(r=>r.uri==a.object_id);o>=0&&(u.value[o]=a.data)}else if(a.event==z.MEDIA_ITEM_PLAYED){const o=u.value.findIndex(r=>r.uri==a.object_id);o>=0&&("fully_played"in u.value[o]&&(u.value[o].fully_played=a.data.fully_played),"resume_position_ms"in u.value[o]&&(u.value[o].resume_position_ms=a.data.seconds_played*1e3))}});ie(()=>{pe.off("clearSelection"),s()})});const x=function(t,s=!1){return t?"translation_key"in t&&t.translation_key&&t.name?g(t.translation_key,[t.name]):"translation_key"in t&&t.translation_key?g(t.translation_key):s&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},Ze=function(t,s){let a=[];if(s.search){const o=s.search.toLowerCase();for(const r of t)(r.name.toLowerCase().includes(o)||"album"in r&&r.album?.name.toLowerCase().includes(o)||"artists"in r&&r.artists&&r.artists.length&&r.artists[0].name.toLowerCase().includes(o))&&a.push(r)}else a=[...t];return s.sortBy=="name"&&a.sort((o,r)=>x(o).localeCompare(x(r),void 0,{numeric:!0})),s.sortBy=="sort_name"&&a.sort((o,r)=>x(o,!0).localeCompare(x(r,!0),void 0,{numeric:!0})),s.sortBy=="name_desc"&&a.sort((o,r)=>x(r).localeCompare(x(o),void 0,{numeric:!0})),s.sortBy=="sort_name_desc"&&a.sort((o,r)=>x(r,!0).localeCompare(x(o,!0),void 0,{numeric:!0})),s.sortBy=="album"&&a.sort((o,r)=>x(o.album).localeCompare(x(r.album),void 0,{numeric:!0})),s.sortBy=="artist"&&a.sort((o,r)=>x(o.artists[0]).localeCompare(x(r.artists[0]))),s.sortBy=="track_number"&&(a.sort((o,r)=>(o.track_number||0)-(r.track_number||0)),a.sort((o,r)=>(o.disc_number||0)-(r.disc_number||0))),s.sortBy=="position"&&a.sort((o,r)=>(o.position||0)-(r.position||0)),s.sortBy=="position_desc"&&a.sort((o,r)=>(r.position||0)-(o.position||0)),s.sortBy=="year"&&a.sort((o,r)=>(o.year||0)-(r.year||0)),s.sortBy=="year_desc"&&a.sort((o,r)=>(r.year||0)-(o.year||0)),s.sortBy=="recent"&&a.sort((o,r)=>(r.timestamp_added||0)-(o.timestamp_added||0)),s.sortBy=="duration"&&a.sort((o,r)=>(o.duration||0)-(r.duration||0)),s.sortBy=="duration_desc"&&a.sort((o,r)=>(r.duration||0)-(o.duration||0)),s.sortBy=="provider"&&a.sort((o,r)=>o.provider.localeCompare(r.provider)),s.favoritesOnly&&(a=a.filter(o=>o.favorite)),s.albumType&&s.albumType.length>0&&(a=a.filter(o=>s.albumType?.includes(o.album_type))),a.slice(s.offset,s.offset+s.limit)},he=async function(){let t=!0;(i.total||F.value.length)>250&&(t=await new Promise(a=>{confirm(g("select_all_confirmation"))?a(!0):a(!1)})),t&&(await qe(),h.value=u.value,V.value=!0)};return(t,s)=>e.hideOnEmpty&&u.value.length==0?f("",!0):(n(),p("section",ua,[b(et,{icon:e.icon,title:e.title,count:l.value.search?u.value.length:e.total||F.value.length,color:"transparent","menu-items":Je.value,onTitleClicked:Z},{title:c(()=>[$t(t.$slots,"title",{},()=>[I(v(e.title),1)],!0)]),_:3},8,["icon","title","count","menu-items"]),b(At),ve.value?(n(),m(Pt,{key:0,id:"searchInput",modelValue:l.value.search,"onUpdate:modelValue":s[0]||(s[0]=a=>l.value.search=a),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:s[1]||(s[1]=a=>T.value=!0),onBlur:s[2]||(s[2]=a=>T.value=!1),"onClick:clear":He},null,8,["modelValue","label"])):f("",!0),N.value?(n(),m(_e,{key:1,variant:k.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:c(()=>[d.value?(n(),m(Ct,{key:0,color:"accent",height:"4",indeterminate:"",rounded:""})):f("",!0),!J.value&&!(u.value.length==0&&E.value)?(n(),m(Ot,{key:1,onLoad:de,mode:e.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:c(()=>[k.value=="panel"?(n(),m(Ie,{key:0},{default:c(()=>[(n(!0),p(ke,null,we(u.value,a=>(n(),m(Se,{key:a.uri,cols:"12",class:P(`col-${y(ge)(t.$vuetify.display.width)}`)},{default:c(()=>[b(na,{item:a,"is-selected":ee(a),"show-checkboxes":V.value,"show-actions":["tracks","albums","albumtracks"].includes(e.itemtype),"show-track-number":e.showTrackNumber,"is-available":y(le)(a),"is-playing":te(a,e.itemtype),"parent-item":e.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","show-actions","show-track-number","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):f("",!0),k.value=="panel_compact"?(n(),m(Ie,{key:1},{default:c(()=>[(n(!0),p(ke,null,we(u.value,a=>(n(),m(Se,{key:a.uri,cols:"12",class:P(`col-${y(ge)(t.$vuetify.display.width)}`)},{default:c(()=>[b(Vt,{item:a,"is-selected":ee(a),"show-checkboxes":V.value,"is-available":y(le)(a),"is-playing":te(a,e.itemtype),"parent-item":e.parentItem,onSelect:ae},null,8,["item","is-selected","show-checkboxes","is-available","is-playing","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):f("",!0),k.value=="list"?(n(),m(Et,{key:2,"item-height":70,height:"100%",items:u.value,style:{height:"100%",overflow:"hidden"}},{default:c(({item:a})=>[b(aa,{item:a,"show-track-number":e.showTrackNumber,"show-disc-number":e.showTrackNumber,"show-duration":e.showDuration,"show-favorite":e.showFavoritesOnlyFilter,"show-menu":a.is_playable,"show-provider":e.showProvider,"show-album":e.showAlbum,"show-checkboxes":V.value,"is-selected":ee(a),"is-available":y(le)(a),"is-playing":te(a,e.itemtype),"show-details":e.itemtype.includes("versions"),"parent-item":e.parentItem,onSelect:ae},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","is-playing","show-details","parent-item"])]),_:1},8,["items"])):f("",!0)]),_:1},8,["mode","load-more-text"])):f("",!0),!d.value&&u.value.length==0?(n(),p("div",ra,[!d.value&&u.value.length==0&&(l.value.search||l.value.favoritesOnly)?(n(),m(Be,{key:0,title:t.$t("no_content_filter")},{default:c(()=>[l.value.search?(n(),m(W,{key:0,style:{"margin-top":"15px"},onClick:We},{default:c(()=>[I(v(t.$t("try_global_search")),1)]),_:1})):f("",!0)]),_:1},8,["title"])):!d.value&&u.value.length==0?(n(),m(Be,{key:1},{default:c(()=>[I(v(t.$t("no_content")),1)]),_:1})):f("",!0)])):f("",!0),b(Lt,{"model-value":h.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:c(()=>[b(W,{color:"primary",variant:"text",onClick:s[3]||(s[3]=a=>y(re)(h.value,a.clientX,a.clientY,e.parentItem))},{default:c(()=>[I(v(t.$t("actions")),1)]),_:1})]),default:c(()=>[R("span",null,v(t.$t("items_selected",[h.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):f("",!0)]))}}),Ca=ce(ca,[["__scopeId","data-v-551a2a2b"]]);export{Ca as I};
