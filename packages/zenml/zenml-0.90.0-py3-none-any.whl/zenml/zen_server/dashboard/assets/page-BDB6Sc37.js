import{r as d,j as s}from"./@radix-3bj3otF9.js";import{x as b,bb as F,bc as I,B as x,bl as V,bd as D,be as E,D as A,I as h,bm as _,bh as z,bi as k,y as v,z as t,al as K,bj as q,ac as O,u as B,l as M,e as U,A as R,f as H,s as L,h as G}from"./index-Cs2FY84s.js";import{u as P}from"./update-current-user-mutation-C8cVTzXV.js";import{t as S}from"./zod-36FJuF1H.js";import{h as T}from"./@tanstack-CByuvRcg.js";import{u as C}from"./index.esm-DnoyTjte.js";import{P as J}from"./PasswordChecker-Db0kzqRu.js";import{u as W}from"./UpdatePasswordSchemas-Ctq0f_ux.js";import"./@react-router-Ct_TgVUW.js";import"./@reactflow-CwWcBchH.js";const X=t.object({avatarUrl:t.string().transform(e=>(e==null?void 0:e.trim())??null)});function Y(){const[e,a]=d.useState(!1),n=T(),{toast:c}=b(),m=P({onSuccess:()=>{n.invalidateQueries({queryKey:["current-user"]}),n.invalidateQueries({queryKey:["users"]}),a(!1)},onError:r=>{r instanceof Error&&c({status:"error",emphasis:"subtle",icon:s.jsx(v,{className:"h-5 w-5 shrink-0 fill-error-700"}),description:r.message,rounded:!0})}}),l=C({resolver:S(X),defaultValues:{avatarUrl:""}});function p(r){m.mutate({avatar_url:r.avatarUrl})}function u(r){a(r),l.reset()}return s.jsxs(F,{open:e,onOpenChange:u,children:[s.jsx(I,{asChild:!0,children:s.jsxs(x,{intent:"secondary",size:"md",className:"absolute right-1 top-1 flex h-6 w-6 items-center justify-center bg-theme-surface-primary",children:[s.jsx("span",{className:"sr-only",children:"Edit Avatar"}),s.jsx(V,{className:"h-5 w-5 shrink-0 fill-theme-text-primary"})]})}),s.jsxs(D,{children:[s.jsx(E,{children:s.jsx(A,{children:"Update Avatar"})}),s.jsxs("div",{className:"p-7",children:[s.jsx("form",{id:"image-form",onSubmit:l.handleSubmit(p),children:s.jsxs("label",{className:"space-y-0.5",children:[s.jsx("div",{className:"text-text-sm",children:"Avatar URL"}),s.jsx(h,{placeholder:"https://zenml.io/logo.png",className:"w-full",...l.register("avatarUrl")})]})}),s.jsx(_,{className:"mt-1 border-none text-text-xs text-theme-text-secondary",children:"This will be profile avatar"})]}),s.jsx(z,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(k,{asChild:!0,children:s.jsx(x,{intent:"secondary",children:"Cancel"})}),s.jsx(x,{type:"submit",form:"image-form",intent:"primary",disabled:m.isPending||!l.formState.isValid,children:"Update"})]})})]})]})}function Z(){const[e,a]=d.useState(!1);return s.jsxs(F,{onOpenChange:()=>{a(!1)},children:[s.jsx(I,{asChild:!0,children:s.jsx(x,{size:"md",className:"shrink-0",intent:"primary",emphasis:"subtle",children:"Change Password"})}),s.jsxs(D,{children:[s.jsx(E,{children:s.jsx(A,{children:" Update Credentials"})}),e?s.jsx(ss,{}):s.jsx($,{setSuccess:a})]})]})}function $({setSuccess:e}){var f;const a=d.useId(),n=d.useId(),c=d.useId(),{toast:m}=b(),{mutate:l,isPending:p}=P({onSuccess(){e(!0)},onError(o){q(o)&&m({status:"error",emphasis:"subtle",icon:s.jsx(v,{className:"h-5 w-5 shrink-0 fill-error-700"}),description:o.message,rounded:!0})}}),{register:u,handleSubmit:r,watch:w,formState:{isValid:N,errors:y}}=C({resolver:S(W),mode:"onChange",criteriaMode:"all"});function g(o){l({old_password:o.oldPassword,password:o.newPassword})}const j=(f=y.newPassword)==null?void 0:f.types;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-5 p-7",children:[s.jsx("form",{id:"update-password-form",onSubmit:r(g),children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:a,className:"text-text-sm",children:"Old Password"}),s.jsx(h,{...u("oldPassword"),type:"password",id:a,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:n,className:"text-text-sm",children:"New Password"}),s.jsx(h,{...u("newPassword"),type:"password",id:n,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:c,className:"text-text-sm",children:"Confirm Password"}),s.jsx(h,{...u("confirmPassword"),type:"password",id:c,className:"w-full"})]})]})}),s.jsx(J,{val:w("newPassword"),errors:j||[]})]}),s.jsxs(z,{className:"gap-[10px]",children:[s.jsx(k,{asChild:!0,children:s.jsx(x,{size:"sm",intent:"secondary",children:"Cancel"})}),s.jsx(x,{disabled:!N||p,form:"update-password-form",size:"sm",children:"Update Password"})]})]})}function ss(){return s.jsxs("div",{className:"space-y-5 p-7 text-center",children:[s.jsx(K,{className:"mx-auto h-[110px] w-[110px] fill-success-500"}),s.jsx("p",{className:"text-text-lg font-semibold text-theme-text-primary",children:"The password was updated successfully!"})]})}const es=t.object({fullName:t.union([t.string(),t.literal("")]),username:t.union([t.string(),t.literal("")]),email:t.union([t.string().email(),t.literal("")])}).refine(e=>e.fullName!==""||e.username!==""||e.email!=="");function as({user:e}){var j,f,o;const a=T(),{toast:n}=b(),c=d.useId(),m=d.useId(),l=d.useId(),{isPending:p,mutate:u}=P({onError(i){q(i)&&n({status:"error",emphasis:"subtle",icon:s.jsx(v,{className:"h-5 w-5 shrink-0 fill-error-700"}),description:i.message,rounded:!0})},onSuccess:()=>{a.invalidateQueries({queryKey:["current-user"]}),a.invalidateQueries({queryKey:["users"]}),w(),n({status:"success",emphasis:"subtle",rounded:!0,description:"User updated successfully"})}}),{register:r,reset:w,handleSubmit:N,formState:{isValid:y}}=C({resolver:S(es),defaultValues:{email:void 0,fullName:void 0,username:void 0}});function g(i){const Q={...i.fullName&&{full_name:i.fullName},...i.username&&{name:i.username},...i.email&&{email:i.email}};u(Q)}return s.jsxs("div",{className:"w-full max-w-[600px]",children:[s.jsx("form",{onSubmit:N(g),children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:c,className:"text-text-sm",children:"Full Name"}),s.jsx(h,{placeholder:(j=e.body)==null?void 0:j.full_name,...r("fullName"),id:c,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:m,className:"text-text-sm",children:"Username"}),s.jsx(h,{...r("username"),placeholder:e.name,id:m,className:"w-full"})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("label",{htmlFor:l,className:"text-text-sm",children:"Email"}),s.jsx(h,{placeholder:((f=e.metadata)==null?void 0:f.email)??void 0,...r("email"),id:l,className:"w-full"})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(x,{disabled:p||!y,size:"md",intent:"primary",children:"Update"})})]})}),s.jsx(Z,{}),s.jsxs("p",{className:"mt-5 text-text-sm text-theme-text-secondary",children:["Created on ",s.jsx(O,{dateString:((o=e.body)==null?void 0:o.created)||""})]})]})}function xs(){var a;const{data:e}=B();return s.jsxs(M,{className:"flex flex-col gap-5 p-5",children:[s.jsx("h1",{className:"text-text-xl font-semibold",children:"Profile"}),s.jsxs("div",{className:"flex justify-between",children:[e?s.jsx(as,{user:e}):s.jsx(U,{className:"h-[350px] w-full"}),e?s.jsxs(R,{size:"xxl",className:"ml-5 h-[140px] w-[140px]",type:"square",children:[s.jsx(H,{src:L(((a=e.body)==null?void 0:a.avatar_url)??void 0)}),s.jsx(G,{className:"text-display-lg",size:"xxl",children:e.name[0]}),s.jsx(Y,{})]}):s.jsx(U,{className:"h-[140px] w-[140px] rounded-rounded"})]})]})}export{xs as default};
