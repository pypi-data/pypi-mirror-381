import{r as j,j as t}from"./@radix-3bj3otF9.js";import{c as g}from"./helper-BXlR2ZLp.js";import{P as y}from"./Pagination-Du1A_aqP.js";import{ad as v,r as m,a1 as d,a9 as P,ae as S,ab as b,ac as D,af as x,e as p,a4 as N,B as w,z as o}from"./index-Cs2FY84s.js";import{b as h}from"./@tanstack-CByuvRcg.js";import{D as C}from"./deployment-status-tag-7j1Qxmk2.js";import{L as u,f as F,a as R}from"./@react-router-Ct_TgVUW.js";import{S as T}from"./refresh-BaK7e0kN.js";import{S as B}from"./SearchField-Bd1JmJXg.js";import{B as E}from"./button-group-basic-z1namEya.js";import"./chevron-right-double-BuLe9bCa.js";import"./@reactflow-CwWcBchH.js";import"./index-FwZ5fdjO.js";import"./trash-B0fyghWi.js";import"./DeleteAlertDialog-8-J1PO_I.js";import"./zod-36FJuF1H.js";import"./index.esm-DnoyTjte.js";const{ContextProvider:_,useContext:l}=g();function k(){return j.useMemo(()=>[{id:"name",header:"Deployment",accessorFn:s=>s.name,cell:({row:s})=>{const e=s.original.name,a=s.original.id;return t.jsxs("div",{className:"group/copybutton flex items-center gap-2",children:[t.jsx(v,{className:"h-5 w-5 fill-primary-400"}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(u,{to:m.projects.deployments.detail.overview(a),className:"flex items-center gap-1",children:t.jsx("span",{className:"text-text-md font-semibold text-theme-text-primary",children:e??"Unnamed"})}),t.jsx(d,{copyText:e??""})]}),t.jsxs(u,{to:m.projects.deployments.detail.overview(a),className:"flex items-center gap-1",children:[t.jsx("p",{className:"text-text-xs text-theme-text-secondary",children:P(a)}),t.jsx(d,{copyText:a})]})]})]})}},{id:"status",header:"Status",accessorFn:s=>{var e;return(e=s.body)==null?void 0:e.status},cell:({row:s})=>{var a;const e=(a=s.original.body)==null?void 0:a.status;return e?t.jsx(C,{status:e}):t.jsx("div",{children:"No status"})}},{id:"snapshot",header:"Snapshot",accessorFn:s=>{var e,a;return(a=(e=s.resources)==null?void 0:e.snapshot)==null?void 0:a.name},cell:({row:s})=>{var n;const e=(n=s.original.resources)==null?void 0:n.snapshot,a=e==null?void 0:e.name,r=e==null?void 0:e.id;return!a||!r?null:t.jsx(S,{snapshotId:r,snapshotName:a})}},{id:"author",header:"Author",accessorFn:s=>{var e,a;return(a=(e=s.resources)==null?void 0:e.user)==null?void 0:a.name},cell:({row:s})=>{var a,r,n;const e=(a=s.original.resources)==null?void 0:a.user;return e?t.jsx(b,{username:e.name,isServiceAccount:!!((r=e.body)!=null&&r.is_service_account),avatarUrl:((n=e.body)==null?void 0:n.avatar_url)??void 0}):null}},{id:"created",header:"Created at",accessorFn:s=>{var e;return{date:(e=s.body)==null?void 0:e.created}},cell:({getValue:s})=>{const{date:e}=s();return t.jsx(D,{dateString:e})}}],[])}function A({params:s}){const{rowSelection:e,setRowSelection:a}=l(),r=k(),n=h({...x.list(s),throwOnError:!0});if(n.isPending)return t.jsxs("div",{className:"flex flex-col items-center gap-5",children:[t.jsx("div",{className:"w-full",children:t.jsx(p,{className:"h-[500px] w-full"})}),t.jsx(p,{className:"h-[36px] w-[300px]"})]});if(n.isError)return t.jsx("p",{children:"Error fetching deployments"});const i=n.data;return t.jsxs("div",{className:"flex flex-col items-center gap-5",children:[t.jsx("div",{className:"w-full",children:t.jsx(N,{columns:r,data:i.items,rowSelection:e,onRowSelectionChange:a,getRowId:f=>f.id})}),i.total_pages>1&&t.jsx(y,{searchParams:s,paginate:i})]})}function I(){const{selectedRowCount:s}=l();async function e(){}return t.jsx(E,{itemName:"Pipeline Snapshot",selectedItemCount:s,onDeleteSelected:e})}function L({params:s}){const{refetch:e}=h({...x.list(s),throwOnError:!0}),{selectedRowCount:a}=l();return t.jsxs("div",{className:"flex items-center justify-between",children:[a?t.jsx(I,{}):t.jsx(B,{searchParams:s}),t.jsxs(w,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>e(),children:[t.jsx(T,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})]})}const c=1,U=o.object({page:o.coerce.number().min(c).optional().default(c).catch(c),name:o.string().optional(),operator:o.enum(["and","or"]).optional()});function G(){const[s]=F(),{page:e,name:a,operator:r}=U.parse({page:s.get("page")||void 0,name:s.get("name")||void 0});return{page:e,name:a,logical_operator:r}}function Q(){const{pipelineId:s}=R(),a={...G(),pipeline:s,sort_by:"desc:updated"};return t.jsxs(t.Fragment,{children:[t.jsx(L,{params:a}),t.jsx(A,{params:a})]})}function re(){return t.jsx("div",{className:"space-y-5",children:t.jsx(_,{children:t.jsx(Q,{})})})}export{re as default};
