import os
import sys
import pytest

sys.path.append(os.path.join(os.path.dirname(__file__), ".."))

from roadmapper.roadmap import Roadmap
from roadmapper.timelinemode import TimelineMode


@pytest.mark.unit
def test_defect_106a():
    roadmap = Roadmap(1800, 400, colour_theme="BLUEMOUNTAIN", show_marker=True)
    roadmap.set_title("My Demo Roadmap")
    roadmap.set_subtitle("Matariki Technologies Ltd")

    roadmap.set_timeline(
        TimelineMode.WEEKLY,
        start="2024-12-01",
        number_of_items=24,
        show_first_day_of_week=True,
    )

    group = roadmap.add_group("Core Product Work Stream")

    group.add_task("Base Functionality", "2024-12-01", "2025-01-05")
    group.add_task("Enhancements12", "2025-01-06", "2025-03-31")

    roadmap.set_footer("Generated by Roadmapper")
    roadmap.draw()

    roadmap.save("images/defects/issue-106.png")


@pytest.mark.unit
def test_defect_106b():
    roadmap = Roadmap(1800, 400, colour_theme="BLUEMOUNTAIN", show_marker=True)
    roadmap.set_title("My Demo Roadmap")
    roadmap.set_subtitle("Matariki Technologies Ltd")

    roadmap.set_timeline(
        TimelineMode.WEEKLY,
        start="2024-12-01",
        number_of_items=24,
        show_first_day_of_week=True,
    )

    group = roadmap.add_group("Core Product Work Stream")

    group.add_task("Base Functionality", "2024-12-01", "2025-01-05")
    g1 = group.add_task("Enhancements12", "2025-01-06", "2025-03-31")
    g1.add_milestone("Milestone 1", "2025-02-05")

    roadmap.set_footer("Generated by Roadmapper")
    roadmap.draw()

    roadmap.save("images/defects/issue-106b.png")


@pytest.mark.unit
def test_defect_113():
    roadmap = Roadmap(
        1000,
        612,
        auto_height=True,
        colour_theme="BLUEMOUNTAIN",
    )
    roadmap.set_title("ROADMAP EXAMPLE")
    roadmap.set_subtitle("This is a subtitle")
    roadmap.set_timeline(
        TimelineMode=TimelineMode.MONTHLY,
        start="2025-06-01",
        number_of_items=12,
        show_generic_dates=False,
    )

    group = roadmap.add_group("Showcase Task Styles")

    task = group.add_task("Rectangle Style", "2025-10-15", "2025-11-20")
    task.add_milestone("v.1.0", "2025-11-01")
    task = group.add_task("Rounded Style", "2025-11-05", "2025-12-20", style="rounded")
    task.add_milestone("v.A", "2025-12-01")
    task = group.add_task(
        "Arrowhead Style", "2025-10-15", "2026-01-20", style="arrowhead"
    )
    task.add_milestone("v.2.0", "2025-10-18")

    # roadmap.set_footer("Author: CS Goh " + datetime.now().strftime("%Y-%m-%d"))
    roadmap.draw()
    roadmap.save("images/defects/issue-113.png")


if not os.path.exists("images"):
    os.mkdir("images")

if not os.path.exists("images/defects"):
    os.mkdir("images/defects")

test_defect_106b()
