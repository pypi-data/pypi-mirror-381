import{w as I,l as r,p as j,f as y,a as N,$,g as _,d as v}from"../chunks/CH6P3X75.js";import{b as P}from"../chunks/CxFKfZ9T.js";import{c as L}from"../chunks/BND_-4Kp.js";import{u as A}from"../chunks/6t3IJ0vQ.js";import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{e as k}from"../chunks/D4whDBUi.js";import{c as E,a as T}from"../chunks/RmD8FzRo.js";import{i as D,s as O,a as F}from"../chunks/DA6bFLPR.js";import{p as x}from"../chunks/keKYsoph.js";import{g as b}from"../chunks/DEgUu98i.js";import{r as w}from"../chunks/H7C68rOM.js";import{S as M}from"../chunks/BdfTHw61.js";const z=({dataset_id:n,sampleIndex:s,tagIds:h,annotationLabelIds:u,min_width:a,max_width:l,min_height:o,max_height:p,textEmbedding:m,metadataValues:c})=>{const i=I({isLoading:!1});return(async()=>{i.update(e=>({...e,isLoading:!0,error:void 0}));try{const{data:e}=await P({path:{dataset_id:n},body:{pagination:{offset:s<1?0:s-1,limit:3},filters:{annotation_label_ids:u,tag_ids:h,width:{min:a,max:l},height:{min:o,max:p},metadata_filters:c?L(c):void 0},text_embedding:m},throwOnError:!0}),{setSamplesTotalCount:t}=A();t(e==null?void 0:e.total_count);let d;const g=s>0?e.data[0]:void 0;e.data.length>2&&(d=s==0?e.data[1]:e.data[2]),i.update(S=>({...S,isLoading:!1,sampleNext:d,samplePrevious:g,error:void 0}))}catch(e){i.update(t=>({...t,isLoading:!1,error:e.message||"Failed to load adjacent samples"}))}})(),i},C=async({parent:n,params:{dataset_id:s,sampleId:h,sampleIndex:u}})=>{var f,e,t,d,g;const{samplesSelectedTagsIds:a,samplesSelectedAnnotationLabelsIds:l,samplesDimensions:o,samplesTextEmbedding:p}=await n(),m=parseInt(u,10),{metadataValues:c}=A();return{sampleAdjacents:z({dataset_id:s,sampleIndex:m,tagIds:Array.from(r(a)),annotationLabelIds:Array.from(r(l)),min_width:(f=r(o))==null?void 0:f.min_width,max_width:(e=r(o))==null?void 0:e.max_width,min_height:(t=r(o))==null?void 0:t.min_height,max_height:(d=r(o))==null?void 0:d.max_height,textEmbedding:(g=r(p))==null?void 0:g.embedding,metadataValues:r(c)}),sampleIndex:m}},ee=Object.freeze(Object.defineProperty({__proto__:null,load:C},Symbol.toStringTag,{value:"Module"}));function G(n,s){j(s,!0);const[h,u]=O(),a=()=>F(_(o),"$sampleAdjacents",h),l=v(()=>x.data.sampleIndex),o=v(()=>x.data.sampleAdjacents),p=()=>{a().sampleNext&&b(w.toSample({sampleId:a().sampleNext.sample_id,datasetId:a().sampleNext.dataset_id,sampleIndex:_(l)+1}),{invalidateAll:!0})},m=()=>{a().samplePrevious&&b(w.toSample({sampleId:a().samplePrevious.sample_id,datasetId:a().samplePrevious.dataset_id,sampleIndex:_(l)-1}),{invalidateAll:!0})},c=t=>{switch(t.key){case"ArrowRight":p();break;case"ArrowLeft":m();break}};var i=E();k("keydown",$,c);var f=y(i);{var e=t=>{const d=v(()=>!!a().samplePrevious),g=v(()=>!!a().sampleNext);M(t,{get hasPrevious(){return _(d)},get hasNext(){return _(g)},onPrevious:m,onNext:p})};D(f,t=>{a()&&t(e)})}T(n,i),N(),u()}function ae(n){G(n,{})}export{ae as component,ee as universal};
