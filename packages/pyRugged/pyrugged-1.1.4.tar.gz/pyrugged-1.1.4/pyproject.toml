# Copyright 2022-2025 CS GROUP
#
# Licensed to CS GROUP (CS) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# CS licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


# `pyproject.toml` is a configuration file used by packaging tools,
# as well as other tools such as linters, type checkers, etc.
# Tells pip that Cython is required for setup.py to execute.
# https://peps.python.org/pep-0518/
# https://packaging.python.org/en/latest/guides/writing-pyproject-toml/

[build-system]
requires = ["setuptools", "setuptools-scm>=8", "wheel", "cython>=0.29", "numpy>=1.24.1"]
build-backend = "setuptools.build_meta"

[project]
name = "pyRugged"
description = "A sensor to terrain mapping tool"
readme = "README.md"
keywords = ["rugged", "orekit", "hipparchus"]
authors = [
  {name = "CS Group", email = "pyrugged@csgroup.eu"},
]
classifiers = [
  "Development Status :: 5 - Production/Stable",
  "License :: OSI Approved :: Apache Software License",
  "Programming Language :: Python :: 3",
]

requires-python = ">= 3.8"

dynamic = ["version"]
# -> tells pip to use setuptools-scm to determine version
# https://setuptools-scm.readthedocs.io/en/v8.2.1/usage/

dependencies = [
  "numpy>=1.24.1",
  "scipy>=1.10",
  "orekit-jcc>=13.1.0",
]

[dependency-groups]
test = [
  "pytest-cython",
  "pytest-order",
  "pytest-timestamper",
  "pytest",
]
qa = [
  "bandit",
  "black>=21.5b0",
  "flake8-bugbear>=21.4.3",
  "flake8-comprehensions>=3.4.0",
  "flake8-copyright>=0.2.2",
  "flake8>=3.9.1",
  "isort>=5.8.0",
  "pylint>=2.13.6",
  "pytest-cov",
]
doc = [
  "sphinx",
  "sphinx-rtd-theme",
]
dev = [
  "pre-commit",
  "validate-pyproject",
  "cython >=0.29",  # for pylint setup.py in pre-commit
  {include-group = "test"},
  {include-group = "typing"},
  {include-group = "qa"},
  {include-group = "doc"},
]
notebook = [
  "jupyter",
  "matplotlib",
]
typing = [
    "mypy",
    "types-setuptools",
]

[tool.setuptools]
package-dir = {"pyrugged" = "pyrugged"}
package-data = {"pyrugged" = ["data/orekit-data-master"]}
# https://setuptools.pypa.io/en/latest/userguide/datafiles.html

[tool.setuptools_scm]
# can be empty if no extra settings are needed, presence enables setuptools-scm

[project.urls]
Homepage = "https://gitlab.eopf.copernicus.eu/geolib/pyrugged"
Documentation = "https://geolib.pages.eopf.copernicus.eu/pyrugged/"
Repository = "https://gitlab.eopf.copernicus.eu/geolib/pyrugged.git"
Issues = "https://gitlab.eopf.copernicus.eu/geolib/pyrugged/-/issues"
Changelog = "https://gitlab.eopf.copernicus.eu/geolib/pyrugged/-/blob/main/CHANGELOG.md"

[tool.bandit]
exclude_dirs = [".venv", "tests"]

[tool.black]
line-length = 120
exclude = "(.eggs|.git|.mypy_cache|.nox|.tox|.venv|_build|build|dist|venv)"

[tool.mypy]
warn_return_any = true
warn_unused_configs = true
warn_redundant_casts = true

[tool.isort]
profile = "black"
line_length = 120

[tool.pytest.ini_options]
log_format = "%(asctime)s.%(msecs)03d %(levelname)s %(filename)s:%(lineno)d %(message)s"
log_cli = true
log_cli_level = "INFO"
log_file_level = "INFO"

markers = [
  "unit_tests",
  "perf",
]
testpaths = ["tests"]

# Ignore DeprecationWarnings from JCC (Orekit)
# https://issues.apache.org/jira/browse/PYLUCENE-51
# https://issues.apache.org/jira/browse/PYLUCENE-59
# https://docs.pytest.org/en/stable/how-to/capture-warnings.html
# https://docs.python.org/3/library/warnings.html#warning-filter
filterwarnings = [
    "ignore::DeprecationWarning:importlib._bootstrap",
]
