# https://docs.readthedocs.io/en/stable/config-file/v2.html

version: 2

build:
  os: ubuntu-24.04
  tools: {}

  # in order to have RTD use our tox configuration for the build, we take full
  # control over 'build.commands'
  # see also: https://github.com/astral-sh/uv/issues/10074#issuecomment-3128225815
  commands:
    # install/setup uv
    - asdf plugin add uv
    - asdf install uv latest
    - asdf global uv latest
    # use uv to get
    # - Python 3.13
    # - tox (with tox-uv)
    - uv tool install tox --with tox-uv --python "3.13" --managed-python
    # create the tox environment (`--notest` skips commands)
    - uv tool run tox run -e build-docs --notest -vvvvv
    # do the actual build step, to the RTD documented output directory
    - uv tool run tox run -e build-docs --skip-pkg-install -q -- "${READTHEDOCS_OUTPUT}"/html -b dirhtml
