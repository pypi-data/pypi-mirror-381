{% load icons %}
<div class="row rules-repeatable">
    <div class="input-group input-group-sm mb-2">
        <div class="form-floating">
            <select class="form-control select" name="rule.action" id="action{{ index }}">
                {% for act_name, act_lbl in rule_actions %}
                    <option value="{{ act_name }}"
                            {% if rule.action == act_name %}selected="selected"{% endif %}
                    >{{ act_lbl }}</option>
                {% endfor %}
            </select>
            <label for="action{{ index }}">Action</label>
        </div>
        <div class="form-floating">
            <select class="form-control select" name="rule.field" id="field{{ index }}">
                <option value=""></option>
                {% for fn, fl in field_choices %}
                    <option value="{{ fn }}"
                            {% if rule.field == fn %}selected="selected"{% endif %}
                    >{{ fl }}</option>
                {% endfor %}
            </select>
            <label for="field{{ index }}">Field</label>
        </div>
        <div class="form-floating">
            <input type="text" class="form-control" id="subfield{{ index }}" name="rule.subfield" value="{{ rule.subfield }}">
            <label for="subfield{{ index }}">Subfield</label>
        </div>

        <div class="form-floating">
            <select class="form-control select" name="rule.operator" id="operator{{ index }}">
                <option value=""></option>
                {% for op_name, op_descr in field_operators %}
                    <option value="{{ op_name }}"
                            {% if rule.operator == op_name %}selected="selected"{% endif %}
                    >{{ op_descr }}</option>
                {% endfor %}
            </select>
            <label for="operator{{ index }}">Operator</label>
        </div>

        <div class="form-floating">
            <input type="text" class="form-control" id="value{{ index }}" name="rule.value" value="{{ rule.value }}">
            <label for="value{{ index }}">Value</label>
        </div>
        <button type="button" class="btn btn-danger remove-repeat">{% svg_icon "x" size=sm %}</button>
    </div>
</div>

