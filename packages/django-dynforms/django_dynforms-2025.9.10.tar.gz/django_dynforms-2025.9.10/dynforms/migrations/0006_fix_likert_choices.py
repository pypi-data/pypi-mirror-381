# Generated by Django 5.2.4 on 2025-09-06 21:25

from django.db import migrations


def fix_field(field):
    if field.get('field_type') == 'likert':
        field['values'] = ['Excellent', 'Good', 'Fair', 'Poor', 'Very Poor']
    return field


def fix_likert_choices(apps, schema_editor):
    FormType = apps.get_model('dynforms', 'FormType')
    db_alias = schema_editor.connection.alias

    to_update = FormType.objects.using(db_alias).all()
    for form_type in to_update:
        for page in form_type.pages:
            page['fields'] = [fix_field(field) for field in page.get('fields', [])]
    FormType.objects.using(db_alias).bulk_update(to_update, ['pages'])


class Migration(migrations.Migration):

    dependencies = [
        ('dynforms', '0005_fix_score_choices'),
    ]

    operations = [
        migrations.RunPython(fix_likert_choices, reverse_code=migrations.RunPython.noop),
    ]
