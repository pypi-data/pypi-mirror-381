<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/assets/favicon.png">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/jerosoler/Drawflow/dist/drawflow.min.css">
    <script src="https://cdn.jsdelivr.net/gh/jerosoler/Drawflow/dist/drawflow.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <title>Xron AI Studio</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p id="loading-message">Compiling workflow...</p>
    </div>

    <div class="studio-container">
        <header class="studio-header">
            <div class="logo-container">
                <div class="header-logo" role="img" aria-label="XronAI Logo"></div>
                <h1>Studio</h1>
            </div>
            <div class="header-actions">
                <button id="theme-toggle-btn" class="icon-btn" title="Toggle Theme">
                    <svg id="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45.16 45.16" fill="currentColor" class="theme-icon"><path d="M22.58 11.269c-6.237 0-11.311 5.075-11.311 11.312s5.074 11.312 11.311 11.312c6.236 0 11.311-5.074 11.311-11.312S28.816 11.269 22.58 11.269zM22.58 7.944a2.207 2.207 0 0 1-2.207-2.206V2.207a2.207 2.207 0 1 1 4.414 0v3.531a2.207 2.207 0 0 1-2.207 2.206zM22.58 37.215a2.207 2.207 0 0 0-2.207 2.207v3.53a2.207 2.207 0 1 0 4.414 0v-3.53a2.208 2.208 0 0 0-2.207-2.207zM32.928 12.231a2.208 2.208 0 0 1 0-3.121l2.497-2.497a2.207 2.207 0 1 1 3.121 3.121l-2.497 2.497a2.207 2.207 0 0 1-3.121 0zM12.231 32.93a2.205 2.205 0 0 0-3.121 0l-2.497 2.496a2.207 2.207 0 0 0 3.121 3.121l2.497-2.498a2.204 2.204 0 0 0 0-3.119zM37.215 22.58c0-1.219.988-2.207 2.207-2.207h3.531a2.207 2.207 0 1 1 0 4.413h-3.531a2.206 2.206 0 0 1-2.207-2.206zM7.944 22.58a2.207 2.207 0 0 0-2.207-2.207h-3.53a2.207 2.207 0 1 0 0 4.413h3.531a2.206 2.206 0 0 0 2.206-2.206zM32.928 32.93a2.208 2.208 0 0 1 3.121 0l2.497 2.497a2.205 2.205 0 1 1-3.121 3.12l-2.497-2.497a2.205 2.205 0 0 1 0-3.12zM12.231 12.231a2.207 2.207 0 0 0 0-3.121L9.734 6.614a2.207 2.207 0 0 0-3.121 3.12l2.497 2.497a2.205 2.205 0 0 0 3.121 0z"></path></svg>                      
                    <svg id="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 448.045" fill="currentColor" class="theme-icon" style="display: none;"><path d="M224.023 448.031c85.715.903 164.012-48.488 200.118-126.23a171.044 171.044 0 0 1-72.118 14.23c-97.156-.11-175.89-78.844-176-176 .973-65.719 37.235-125.832 94.91-157.351A334.474 334.474 0 0 0 224.024.03c-123.714 0-224 100.29-224 224 0 123.715 100.286 224 224 224zm0 0"/></svg>                      
                </button>
                <button id="export-workflow-btn" class="export-btn">Export as YAML</button>
                <div class="mode-switcher">
                    <button id="edit-workflow-btn" class="active">Design</button>
                    <button id="start-chat-btn">Chat</button>
                </div>
            </div>
        </header>

        <main class="studio-main-content">
            <div class="workspace-panel">
                <aside class="icon-toolbar">
                    <button id="add-user-btn" title="Add User (Entry Point)"></button>
                    <button id="add-supervisor-btn" title="Add Supervisor"></button>
                    <button id="add-agent-btn" title="Add Agent"></button>
                    <button id="add-tool-btn" title="Add Built-in Tool"></button>
                    <button id="add-mcp-btn" title="Add MCP Server"></button>
                </aside>
                <section class="canvas" id="drawflow">
                    <div class="canvas-controls">
                        <button id="zoom-in-btn" title="Zoom In">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z" clip-rule="evenodd" /></svg>
                        </button>
                        <button id="zoom-out-btn" title="Zoom Out">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M3.75 12a.75.75 0 0 1 .75-.75h15a.75.75 0 0 1 0 1.5h-15a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd" /></svg>
                        </button>
                        <button id="center-view-btn" title="Center View">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor"><path d="M12 3H6a3 3 0 0 0-3 3v6a1 1 0 0 0 2 0V6a1 1 0 0 1 1-1h6a1 1 0 0 0 0-2zM26 3h-6a1 1 0 0 0 0 2h6a1 1 0 0 1 1 1v6a1 1 0 0 0 2 0V6a3 3 0 0 0-3-3zM28 19a1 1 0 0 0-1 1v6a1 1 0 0 1-1 1h-6a1 1 0 0 0 0 2h6a3 3 0 0 0 3-3v-6a1 1 0 0 0-1-1zM12 27H6a1 1 0 0 1-1-1v-6a1 1 0 0 0-2 0v6a3 3 0 0 0 3 3h6a1 1 0 0 0 0-2z"/></svg>
                        </button>
                        <button id="lock-canvas-btn" title="Lock Canvas">
                            <svg class="lock-icon-unlocked" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M18 1.5c2.9 0 5.25 2.35 5.25 5.25v3.75a.75.75 0 0 1-1.5 0V6.75a3.75 3.75 0 1 0-7.5 0v3a3 3 0 0 1 3 3v6.75a3 3 0 0 1-3 3H3.75a3 3 0 0 1-3-3v-6.75a3 3 0 0 1 3-3h9V6.75a5.25 5.25 0 0 1 5.25-5.25Z" /></svg>
                            <svg class="lock-icon-locked" style="display: none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M12 1.5a5.25 5.25 0 0 0-5.25 5.25v3a3 3 0 0 0-3 3v6.75a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3v-6.75a3 3 0 0 0-3-3v-3c0-2.9-2.35-5.25-5.25-5.25Zm3.75 8.25v-3a3.75 3.75 0 1 0-7.5 0v3h7.5Z" clip-rule="evenodd" /></svg>
                        </button>
                    </div>
                </section>
            </div>

            <div class="resizer" data-direction="vertical"></div>

            <section class="contextual-panel">
                <div class="configuration-view">
                     <div class="panel-placeholder">
                        <h2>Configuration</h2>
                        <p>Click a node on the canvas to configure its properties here.</p>
                    </div>
                </div>
                <div class="chat-view">
                    <div id="log" class="log-container"></div>
                    <footer class="chat-footer">
                        <form id="form" class="chat-form">
                            <textarea id="input" placeholder="Type your message... (Shift+Enter for new line)" rows="1"></textarea>
                            <button type="submit" title="Send Message">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" fill="currentColor" class="send-icon"><path d="m26.208 13.545-24-11A.5.5 0 0 0 1.5 3v8a.5.5 0 0 0 .356.479L10.26 14l-8.4 2.521A.5.5 0 0 0 1.5 17v8a.5.5 0 0 0 .5.5.488.488 0 0 0 .208-.046l24-11a.5.5 0 0 0 0-.91z"/></svg>                                  
                            </button>
                        </form>
                    </footer>
                </div>
            </section>
        </main>
    </div>

    <div id="add-tool-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>Select a Tool</h2>
            <div id="tool-list" class="tool-list-container">
            </div>
            <button id="close-tool-modal-btn" class="modal-close-btn">Cancel</button>
        </div>
    </div>

    <script src="/app.js"></script>
</body>
</html>