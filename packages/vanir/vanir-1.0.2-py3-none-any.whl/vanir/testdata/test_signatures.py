# Copyright 2023 Google LLC
#
# Use of this source code is governed by a BSD-style
# license that can be found in the LICENSE file or at
# https://developers.google.com/open-source/licenses/bsd

"""Signatures to be checked against in Vanir integration test.
"""

from vanir import signature

EXPECTED_SIGNATURES_KERNEL = frozenset({
    signature.FunctionSignature(
        signature_id='ASB-A-210498909-5bd698a6',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/050fad7c4534c13c8eb1d9c2ba66012e014773cb',
        target_file='kernel/bpf/core.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=23171078215908543219710863598493879057,
        length=699,
        target_function='bpf_adj_branches',
    ),
    signature.FunctionSignature(
        signature_id='ASB-A-210498909-5d89291b',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/050fad7c4534c13c8eb1d9c2ba66012e014773cb',
        target_file='kernel/bpf/core.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=102018818739139768709145498743568935218,
        length=623,
        target_function='bpf_patch_insn_single',
    ),
    signature.FunctionSignature(
        signature_id='ASB-A-210498909-c48b4d8b',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/050fad7c4534c13c8eb1d9c2ba66012e014773cb',
        target_file='net/core/filter.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=94912136455276258216923841845314585456,
        length=5803,
        target_function='bpf_convert_filter',
    ),
    signature.LineSignature(
        signature_id='ASB-A-210498909-2522d32a',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/050fad7c4534c13c8eb1d9c2ba66012e014773cb',
        target_file='kernel/bpf/core.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        line_hashes=[
            4068369853657927194428980839065868322,
            167152485479179759057578589714143258046,
            61932533662321792103318294346791905562,
            339492714805587762190195805353133147440,
            302919762978309470386354110818236382513,
            144832242212121954328624081061050384392,
            153638842745362529553262445423701730417,
            100147665825283882195215636736191504367,
            205190837798843308172560534968501498426,
            173970901762395546644789021979320300926,
            147389345724989930213638672912520712298,
            88808675354840579852116135991694888996,
            182805601560323254186553995035505766449,
            13944348185258700762986558820667501605,
            248011887287415928281696650457012880095,
            308708790169767359414374720254854585327,
            208534611505606670992334427465883709128,
            95577131146736644972690569485448305116,
            332130037603741093205820375015725338240,
            140599674152901004127462786867431831021,
            4855730822442951393850001515070092280,
            258165005057310758401030900501881429630,
            299894238014067000145848413923388423986,
            100427090150523461897519300442432502015,
            54387929084162727674152375576833409610,
            335836839221632050964073395885043864621,
            7114672059116645309340870171691279746,
            86002190496145399075523303756553517243,
            183951289535884891518533137541054529446,
            10535567095338283468722937641299901393,
            32509241087432694058801181236401322413,
            81310277444280958553262261991046577644,
            267576612309536264367328137551242410206,
            1586213858173207712517941791783010534,
            150172589696412652438710907169476586346,
            173830055080749042841403443394806161084,
            247962124674783255679416338753482278757,
            219501349876708076604453452843841746102,
            71499824953729254730456790874389304509,
            60824873152671740083845907681015696768,
            228210027844020424601669381948675047203,
            108799780275091454062354526622343423598,
            279930636295448399857114219411784553352,
            168695483562943863284802268259048493488,
            168031096851926874643172795332769205044,
            263404072542572084144604067425367524789,
        ],
        threshold=0.9,
    ),
    signature.LineSignature(
        signature_id='ASB-A-210498909-a931e0c4',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/050fad7c4534c13c8eb1d9c2ba66012e014773cb',
        target_file='net/core/filter.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        line_hashes=[
            169211069206287344238106283610653699511,
            145557708259871769016900086011684010714,
            179289004688484068144023157234375679009,
            155357570666773493111892299554894607560,
            250041548828663960593191628322720703892,
            202308332790379754708282056451425384933,
            165706870548532707958630588898166269288,
            289254542133906578065764156762145456721,
        ],
        threshold=0.9,
    ),
    signature.FunctionSignature(
        signature_id='ASB-A-210498909-e2fa80cf',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/99253eb750fda6a644d5188fb26c43bad8d5a745',
        target_file='net/ipv6/ip6mr.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=334410933136282710967774068023981460530,
        length=2763,
        target_function='ip6_mroute_setsockopt',
    ),
    signature.FunctionSignature(
        signature_id='ASB-A-210498909-e920a872',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/99253eb750fda6a644d5188fb26c43bad8d5a745',
        target_file='net/ipv6/ip6mr.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=213724507498041325655797406518481755665,
        length=772,
        target_function='ip6_mroute_getsockopt',
    ),
    signature.LineSignature(
        signature_id='ASB-A-210498909-74456a17',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/99253eb750fda6a644d5188fb26c43bad8d5a745',
        target_file='net/ipv6/ip6mr.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        line_hashes=[
            298009621754784947338976317639313641580,
            238898635758313853733269622164346830466,
            164981494354328959081603277826549826038,
            54730709383692090809855170929975497157,
            100812824994221953414922115304082628324,
            161321961574033993320537476681077070219,
            307616960852696608536787177282000021506,
            260955927640175033788372205548123349701,
            3013348516959180471679634323967881011,
            36801583908514757786675713252300506322,
            238898635758313853733269622164346830466,
            164981494354328959081603277826549826038,
        ],
        threshold=0.9,
    ),
    signature.FunctionSignature(
        signature_id='ASB-A-172999675-e2fa80cf',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/99253eb750fda6a644d5188fb26c43bad8d5a745',
        target_file='net/ipv6/ip6mr.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=334410933136282710967774068023981460530,
        length=2763,
        target_function='ip6_mroute_setsockopt',
    ),
    signature.FunctionSignature(
        signature_id='ASB-A-172999675-e920a872',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/99253eb750fda6a644d5188fb26c43bad8d5a745',
        target_file='net/ipv6/ip6mr.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=213724507498041325655797406518481755665,
        length=772,
        target_function='ip6_mroute_getsockopt',
    ),
    signature.LineSignature(
        signature_id='ASB-A-172999675-74456a17',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/99253eb750fda6a644d5188fb26c43bad8d5a745',
        target_file='net/ipv6/ip6mr.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        line_hashes=[
            298009621754784947338976317639313641580,
            238898635758313853733269622164346830466,
            164981494354328959081603277826549826038,
            54730709383692090809855170929975497157,
            100812824994221953414922115304082628324,
            161321961574033993320537476681077070219,
            307616960852696608536787177282000021506,
            260955927640175033788372205548123349701,
            3013348516959180471679634323967881011,
            36801583908514757786675713252300506322,
            238898635758313853733269622164346830466,
            164981494354328959081603277826549826038,
        ],
        threshold=0.9,
    ),
    signature.FunctionSignature(
        signature_id='PUB-A-160818461-482eb047',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/bce1305c0ece3',
        target_file='drivers/hid/hid-core.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=302779128589865924941927860846474042040,
        length=300,
        target_function='hid_output_report',
    ),
    signature.FunctionSignature(
        signature_id='PUB-A-160818461-95d3f56d',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/bce1305c0ece3',
        target_file='drivers/hid/hid-core.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=86180056594490316600717451057640403042,
        length=1264,
        target_function='hid_report_raw_event',
    ),
    signature.LineSignature(
        signature_id='PUB-A-160818461-4606e0d5',
        signature_version='v1',
        source='https://android.googlesource.com/kernel/common/+/bce1305c0ece3',
        target_file='drivers/hid/hid-core.c',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        line_hashes=[
            59279288054240772512122037148835217342,
            211880442018003413039781699765869659646,
            214310009365619240478923272630953271789,
            321971145287701039621919956120198388347,
            207959965809916909403245645649888378685,
            188374904451562885539951987849272656462,
            319458721325611379528885337716549284009,
            104733734344321184961195836625682850135,
            31016265555568093321704658062067679381,
            122010839418486169462622783824556336648,
            107437023064454477683088389321012772659,
        ],
        threshold=0.9,
    ),
})

EXPECTED_SIGNATURES_PLATFORM = frozenset({
    signature.FunctionSignature(
        signature_id='ASB-A-202768292-0cf66e03',
        signature_version='v1',
        source='https://android.googlesource.com/platform/frameworks/base/+/b2dc041a4e84986e3a6932b127d3a18ef02b6d0a',
        target_file='services/core/java/com/android/server/om/OverlayManagerService.java',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=22931789430284818538229315262645915337,
        length=1784,
        target_function='executeRequest',
    ),
    signature.FunctionSignature(
        signature_id='ASB-A-202768292-a6c73092',
        signature_version='v1',
        source='https://android.googlesource.com/platform/frameworks/base/+/b2dc041a4e84986e3a6932b127d3a18ef02b6d0a',
        target_file='services/core/java/com/android/server/om/OverlayManagerService.java',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        function_hash=326322751240508323355186466492298396434,
        length=1337,
        target_function='OverlayManagerService',
    ),
    signature.LineSignature(
        signature_id='ASB-A-202768292-4b745b9d',
        signature_version='v1',
        source='https://android.googlesource.com/platform/frameworks/base/+/b2dc041a4e84986e3a6932b127d3a18ef02b6d0a',
        target_file='services/core/java/com/android/server/om/OverlayManagerService.java',
        exact_target_file_match_only=False,
        match_only_versions=None,
        truncated_path_level=None,
        deprecated=False,
        line_hashes=[
            264047575499705013826057957145778461627,
            74772262489499897834733044985686582819,
            119807025025831525566320421356378051124,
            91008912170575886755658254909050260530,
            308322145304475201728355297492677055162,
            275155973538704798048365005284701952787,
            32400124045898944545581680566210961286,
            274268388700510425115480133473086407073,
            42702381939894791518723683671897731020,
            181485930362381194113622465111492284765,
            74878875272942187113388173881169542538,
            326663632130122039236458743459309863891,
            254975610931225471233459325600541047397,
            124160822546388015943020434133872821608,
        ],
        threshold=0.9,
    ),
})
