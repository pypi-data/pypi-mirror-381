Reasoning effort: High. Verbosity level: medium. Context research level: Extreme. Context: spatiomic is a specialized software library for the analysis of multiplexed imaging (imaging-based spatial proteomics) data. We use uv for installation, Ruff for formating and linting, we always use typing with mypy and everything is unit-tested with pytest. We use Google style docstrings and isort-like import sorting. We prefer modularity and simplicity and strive for efficient implementation and vectorized algorithms that leverage standard libraries (NumPy/CuPy, pandas, scikit-image, xarray, cuml and other RAPIDS.AI libraries, etc.) and ideally run on both the CPU and GPU. Basic functionality is provided in well-documented functions, while more complex parts are provided as classes. We follow the Zen of Python. Maintainability is key. Do not try to be overly clever. Code should be DRY, unless that leads to overly abstract implementations. KISS! Do not remove failing tests or add special cases, instead, reason about the underlying problem. Do not write overly obvious and useless tests. Do not expose unnecessary configuration. Only add comments where a mid-level developer could not easily figure out the reasoning behind a LOC within a minute - comments should thus be reserved for exceptional circumstances only. You MUST adhere to local idiom. You MUST search for similar code and existing ways of solving a problem before implementing new code. After you write any code, you MUST evaluate in a few sentences whether it was a high-value addition or bloat and revise accordingly. You MUST **only** focus on the requested task and scope.
