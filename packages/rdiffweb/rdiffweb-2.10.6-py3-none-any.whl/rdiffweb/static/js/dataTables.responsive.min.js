/*
   Copyright 2014-2015 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license/mit

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
*/
(function(p,q,k){k=function(e,l){var h=function(d,a){if(!l.versionCheck||!l.versionCheck("1.10.1"))throw"DataTables Responsive requires DataTables 1.10.1 or newer";this.s={dt:new l.Api(d),columns:[]};this.s.dt.settings()[0].responsive||(a&&"string"===typeof a.details&&(a.details={type:a.details}),this.c=e.extend(!0,{},h.defaults,l.defaults.responsive,a),d.responsive=this,this._constructor())};h.prototype={_constructor:function(){var d=this,a=this.s.dt;a.settings()[0]._responsive=this;e(p).on("resize.dtr orientationchange.dtr",
a.settings()[0].oApi._fnThrottle(function(){d._resize()}));a.on("destroy.dtr",function(){e(p).off("resize.dtr orientationchange.dtr draw.dtr")});this.c.breakpoints.sort(function(a,d){return a.width<d.width?1:a.width>d.width?-1:0});this._classLogic();this._resizeAuto();var c=this.c.details;c.type&&(d._detailsInit(),this._detailsVis(),a.on("column-visibility.dtr",function(){d._detailsVis()}),a.on("draw.dtr",function(){a.rows({page:"current"}).iterator("row",function(b,c){var g=a.row(c);if(g.child.isShown()){var m=
d.c.details.renderer(a,c);g.child(m,"child").show()}})}),e(a.table().node()).addClass("dtr-"+c.type));this._resize()},_columnsVisiblity:function(d){var a=this.s.dt,c=this.s.columns,b,f,g=e.map(c,function(a){return a.auto&&null===a.minWidth?!1:!0===a.auto?"-":-1!==e.inArray(d,a.includeIn)}),m=0;b=0;for(f=g.length;b<f;b++)!0===g[b]&&(m+=c[b].minWidth);b=a.settings()[0].oScroll;b=b.sY||b.sX?b.iBarWidth:0;a=a.table().container().offsetWidth-b-m;b=0;for(f=g.length;b<f;b++)c[b].control&&(a-=c[b].minWidth);
m=!1;b=0;for(f=g.length;b<f;b++)"-"===g[b]&&!c[b].control&&(m||0>a-c[b].minWidth?(m=!0,g[b]=!1):g[b]=!0,a-=c[b].minWidth);a=!1;b=0;for(f=c.length;b<f;b++)if(!c[b].control&&!c[b].never&&!g[b]){a=!0;break}b=0;for(f=c.length;b<f;b++)c[b].control&&(g[b]=a);-1===e.inArray(!0,g)&&(g[0]=!0);return g},_classLogic:function(){var d=this,a=this.c.breakpoints,c=this.s.dt.columns().eq(0).map(function(a){a=this.column(a).header().className;return{className:a,includeIn:[],auto:!1,control:!1,never:a.match(/\bnever\b/)?
!0:!1}}),b=function(a,b){var d=c[a].includeIn;-1===e.inArray(b,d)&&d.push(b)},f=function(g,f,e,n){if(e)if("max-"===e){n=d._find(f).width;f=0;for(e=a.length;f<e;f++)a[f].width<=n&&b(g,a[f].name)}else if("min-"===e){n=d._find(f).width;f=0;for(e=a.length;f<e;f++)a[f].width>=n&&b(g,a[f].name)}else{if("not-"===e){f=0;for(e=a.length;f<e;f++)-1===a[f].name.indexOf(n)&&b(g,a[f].name)}}else c[g].includeIn.push(f)};c.each(function(b,d){for(var c=b.className.split(" "),n=!1,h=0,k=c.length;h<k;h++){var l=e.trim(c[h]);
if("all"===l){n=!0;b.includeIn=e.map(a,function(a){return a.name});return}if("none"===l||"never"===l){n=!0;return}if("control"===l){n=!0;b.control=!0;return}e.each(a,function(a,b){var c=b.name.split("-"),e=l.match(RegExp("(min\\-|max\\-|not\\-)?("+c[0]+")(\\-[_a-zA-Z0-9])?"));e&&(n=!0,e[2]===c[0]&&e[3]==="-"+c[1]?f(d,b.name,e[1],e[2]+e[3]):e[2]===c[0]&&!e[3]&&f(d,b.name,e[1],e[2]))})}n||(b.auto=!0)});this.s.columns=c},_detailsInit:function(){var d=this,a=this.s.dt,c=this.c.details;"inline"===c.type&&
(c.target="td:first-child");var b=c.target;e(a.table().body()).on("click","string"===typeof b?b:"td",function(f){if(e(a.table().node()).hasClass("collapsed")&&a.row(e(this).closest("tr")).length){if("number"===typeof b&&(f=0>b?a.columns().eq(0).length+b:b,a.cell(this).index().column!==f))return;f=a.row(e(this).closest("tr"));if(f.child.isShown())f.child(!1),e(f.node()).removeClass("parent");else{var c=d.c.details.renderer(a,f[0]);f.child(c,"child").show();e(f.node()).addClass("parent")}}})},_detailsVis:function(){var d=
this,a=this.s.dt,c=a.columns().indexes().filter(function(b){var c=a.column(b);return c.visible()?null:e(c.header()).hasClass("never")?null:b}),b=!0;if(0===c.length||1===c.length&&this.s.columns[c[0]].control)b=!1;b?a.rows({page:"current"}).eq(0).each(function(b){b=a.row(b);if(b.child()){var c=d.c.details.renderer(a,b[0]);!1===c?b.child.hide():b.child(c,"child").show()}}):a.rows({page:"current"}).eq(0).each(function(b){a.row(b).child.hide()})},_find:function(d){for(var a=this.c.breakpoints,c=0,b=a.length;c<
b;c++)if(a[c].name===d)return a[c]},_resize:function(){var d=this.s.dt,a=e(p).width(),c=this.c.breakpoints,b=c[0].name,f=this.s.columns,g;for(g=c.length-1;0<=g;g--)if(a<=c[g].width){b=c[g].name;break}var m=this._columnsVisiblity(b),c=!1;g=0;for(a=f.length;g<a;g++)if(!1===m[g]&&!f[g].never){c=!0;break}e(d.table().node()).toggleClass("collapsed",c);d.columns().eq(0).each(function(a,b){d.column(a).visible(m[b])})},_resizeAuto:function(){var d=this.s.dt,a=this.s.columns;if(this.c.auto&&-1!==e.inArray(!0,
e.map(a,function(a){return a.auto}))){d.table().node();var c=d.table().node().cloneNode(!1),b=e(d.table().header().cloneNode(!1)).appendTo(c),f=e(d.table().body().cloneNode(!1)).appendTo(c);e(d.table().footer()).clone(!1).appendTo(c);d.rows({page:"current"}).indexes().flatten().each(function(a){var b=d.row(a).node().cloneNode(!0);d.columns(":hidden").flatten().length&&e(b).append(d.cells(a,":hidden").nodes().to$().clone());e(b).appendTo(f)});var g=d.columns().header().to$().clone(!1);e("<tr/>").append(g).appendTo(b);
"inline"===this.c.details.type&&e(c).addClass("dtr-inline collapsed");c=e("<div/>").css({width:1,height:1,overflow:"hidden"}).append(c);c.find("th.never, td.never").remove();c.insertBefore(d.table().node());d.columns().eq(0).each(function(b){a[b].minWidth=g[b].offsetWidth||0});c.remove()}}};h.breakpoints=[{name:"desktop",width:Infinity},{name:"tablet-l",width:1024},{name:"tablet-p",width:768},{name:"mobile-l",width:480},{name:"mobile-p",width:320}];h.defaults={breakpoints:h.breakpoints,auto:!0,details:{renderer:function(d,
a){var c=d.cells(a,":hidden").eq(0).map(function(a){var c=e(d.column(a.column).header());a=d.cell(a).index();if(c.hasClass("control")||c.hasClass("never"))return"";var g=d.settings()[0],g=g.oApi._fnGetCellData(g,a.row,a.column,"display");(c=c.text())&&(c+=":");return'<li data-dtr-index="'+a.column+'"><span class="dtr-title">'+c+'</span> <span class="dtr-data">'+g+"</span></li>"}).toArray().join("");return c?e('<ul data-dtr-index="'+a+'"/>').append(c):!1},target:0,type:"inline"}};var k=e.fn.dataTable.Api;
k.register("responsive()",function(){return this});k.register("responsive.index()",function(d){d=e(d);return{column:d.data("dtr-index"),row:d.parent().data("dtr-index")}});k.register("responsive.rebuild()",function(){return this.iterator("table",function(d){d._responsive&&d._responsive._classLogic()})});k.register("responsive.recalc()",function(){return this.iterator("table",function(d){d._responsive&&(d._responsive._resizeAuto(),d._responsive._resize())})});h.version="1.0.7";e.fn.dataTable.Responsive=
h;e.fn.DataTable.Responsive=h;e(q).on("init.dt.dtr",function(d,a,c){if("dt"===d.namespace&&(e(a.nTable).hasClass("responsive")||e(a.nTable).hasClass("dt-responsive")||a.oInit.responsive||l.defaults.responsive))d=a.oInit.responsive,!1!==d&&new h(a,e.isPlainObject(d)?d:{})});return h};"function"===typeof define&&define.amd?define(["jquery","datatables"],k):"object"===typeof exports?k(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.Responsive&&k(jQuery,jQuery.fn.dataTable)})(window,
document);
