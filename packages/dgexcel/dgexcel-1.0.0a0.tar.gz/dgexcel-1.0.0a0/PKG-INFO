Metadata-Version: 2.4
Name: dgexcel
Version: 1.0.0a0
Summary: –ü–∞–∫–µ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel —Ñ–∞–π–ª–∞–º–∏
Home-page: https://gitlab.com/gng-group/dgdb.git
Author: Malanris
Author-email: Roman Rasputin <admin@roro.su>
License: MIT License
Project-URL: Homepage, https://gitlab.com/gng-group/dgexcel
Project-URL: BugTracker, https://gitlab.com/gng-group/dgexcel/issues
Keywords: sqlalchemy,client,postgresql,mssql,oracle
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Operating System :: OS Independent
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: System :: Distributed Computing
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: openpyxl>=3.0.0
Provides-Extra: xls
Requires-Dist: xlwt>=1.3.0; extra == "xls"
Requires-Dist: xlrd>=2.0.0; extra == "xls"
Provides-Extra: full
Requires-Dist: openpyxl>=3.0.0; extra == "full"
Requires-Dist: xlsxwriter>=3.0.0; extra == "full"
Requires-Dist: xlwt>=1.3.0; extra == "full"
Requires-Dist: xlrd>=2.0.0; extra == "full"
Dynamic: author
Dynamic: home-page
Dynamic: license-file

# DGExcel

–ü–∞–∫–µ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel —Ñ–∞–π–ª–∞–º–∏ —Å –º–æ–¥—É–ª—å–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ (.xlsx), —Ç–∞–∫ –∏ —Å—Ç–∞—Ä—ã–µ (.xls) —Ñ–æ—Ä–º–∞—Ç—ã Excel.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üöÄ **–ü—Ä–æ—Å—Ç–æ–π API** - –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ Excel
- üì¶ **–ú–æ–¥—É–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ
- ‚ö° **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞** - –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é —Ñ–∞–π–ª–∞
- üé® **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∏–ª–µ–π** - –≥—Ä–∞–Ω–∏—Ü—ã, —à—Ä–∏—Ñ—Ç—ã, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ
- üìä **–ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å** - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π —Å Excel —Ñ–∞–π–ª–∞–º–∏
- üîÑ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞ —Å–æ —Å—Ç–∞—Ä—ã–º–∏ .xls —Ñ–∞–π–ª–∞–º–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ç–æ–ª—å–∫–æ .xlsx)
```bash
pip install dgexcel
```

### –° –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π .xls —Ñ–∞–π–ª–æ–≤
```bash
pip install dgexcel[xls]
```

### –ü–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–≤—Å–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
```bash
pip install dgexcel[full]
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–≥–æ Excel —Ñ–∞–π–ª–∞

```python
from dgexcel import create_excel

data = [
    {'name': 'John', 'age': 25, 'city': 'New York'},
    {'name': 'Jane', 'age': 30, 'city': 'London'},
    {'name': 'Bob', 'age': 35, 'city': 'Tokyo'}
]

# –°–æ–∑–¥–∞–Ω–∏–µ xlsx —Ñ–∞–π–ª–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
create_excel(data, 'people.xlsx', header=['Name', 'Age', 'City'])

# –°–æ–∑–¥–∞–Ω–∏–µ xls —Ñ–∞–π–ª–∞ (—Ç—Ä–µ–±—É–µ—Ç [xls])
create_excel(data, 'people.xls', header=['Name', 'Age', 'City'])
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ ExcelX –∏ Excel

```python
from dgexcel import ExcelX, Excel

# –†–∞–±–æ—Ç–∞ —Å xlsx —Ñ–∞–π–ª–∞–º–∏
excel_x = ExcelX()
excel_x.create_simple_excel(
    'data.xlsx', 
    [{'product': 'Laptop', 'price': 999}, {'product': 'Mouse', 'price': 25}],
    column_names=['Product', 'Price'],
    worksheet='Products'
)

# –†–∞–±–æ—Ç–∞ —Å xls —Ñ–∞–π–ª–∞–º–∏ (—Ç—Ä–µ–±—É–µ—Ç [xls])
excel_old = Excel()
excel_old.create_simple_excel(
    'data.xls',
    [{'product': 'Keyboard', 'price': 75}, {'product': 'Monitor', 'price': 200}],
    column_names=['Product', 'Price'],
    worksheet='Products'
)
```

### –ß—Ç–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–æ–≤

```python
from dgexcel import read_excel

# –ß—Ç–µ–Ω–∏–µ xlsx —Ñ–∞–π–ª–∞
data_xlsx = read_excel('people.xlsx', ['name', 'age', 'city'])
print(data_xlsx)

# –ß—Ç–µ–Ω–∏–µ xls —Ñ–∞–π–ª–∞ (—Ç—Ä–µ–±—É–µ—Ç [xls])
data_xls = read_excel('people.xls', ['name', 'age', 'city'])
print(data_xls)
```

## –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –†–∞–±–æ—Ç–∞ —Å–æ —Å—Ç–∏–ª—è–º–∏

```python
from dgexcel import ExcelX, BORDER, FONT

excel = ExcelX()

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π
header_style = {
    'bold': True,
    'font': {'size': 12, 'color': 'FFFFFF'},
    'border': BORDER['all'],
    'alignment': {'horizontal': 'center'}
}

cell_style = {
    'border': BORDER['all'],
    'alignment': {'horizontal': 'left'}
}

# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å–æ —Å—Ç–∏–ª—è–º–∏
data = [['Laptop', 999], ['Mouse', 25]]
excel.create_simple_excel(
    'styled.xlsx',
    data,
    column_names=['Product', 'Price'],
    styles=[header_style, cell_style]
)
```

### –ü–æ—Å—Ç—Ä–æ—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

```python
from dgexcel import ExcelX

excel = ExcelX()
excel.open_file('detailed.xlsx')

# –í—ã–±–æ—Ä –ª–∏—Å—Ç–∞
excel.select_worksheet('Data')

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —è—á–µ–π–∫–∞–º
excel.add_cell(1, 1, 'Product', {'bold': True})
excel.add_cell(1, 2, 'Price', {'bold': True})

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
excel.add_row(2, ['Laptop', 999])

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞
excel.add_column(3, [25, 75, 150], start_row=2)

# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —è—á–µ–µ–∫
excel.add_merge_cell(5, 1, 5, 3, 'Total', {'bold': True})

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
excel.save_file()
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ —è—á–µ–µ–∫

```python
from dgexcel import ExcelX

excel = ExcelX()
excel.open_file('formatted.xlsx')

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —à–∏—Ä–∏–Ω—ã —Å—Ç–æ–ª–±—Ü–æ–≤
excel.set_columns_width([20, 15, 10])

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã—Å–æ—Ç—ã —Å—Ç—Ä–æ–∫
excel.set_rows_height([25, 20, 20, 20])

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–π —è—á–µ–π–∫–∏
excel.set_cell_dimension(1, 1, height=30, width=25)

excel.save_file()
```

## API Reference

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã

#### `ExcelX(filename=None)`
–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å .xlsx —Ñ–∞–π–ª–∞–º–∏.

**–ú–µ—Ç–æ–¥—ã:**
- `open_file(filename, rewrite=True)` - –æ—Ç–∫—Ä—ã—Ç–∏–µ/—Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
- `create_simple_excel()` - –±—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
- `add_worksheet(name)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–∏—Å—Ç–∞
- `select_worksheet(name)` - –≤—ã–±–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
- `add_cell(row, col, value, style)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —è—á–µ–π–∫–∏
- `add_row(row, values, start_col, styles)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
- `add_column(col, values, start_row, styles)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞
- `read_file()` - —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–∞
- `save_file()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞

#### `Excel(filename=None)`
–ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å .xls —Ñ–∞–π–ª–∞–º–∏ (—Ç—Ä–µ–±—É–µ—Ç `[xls]`).

–ò–º–µ–µ—Ç —Ç–æ—Ç –∂–µ API —á—Ç–æ –∏ `ExcelX`.

### –£—Ç–∏–ª–∏—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### `create_excel(data, filename, header, column_width, worksheet, start_row, borders)`
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Excel —Ñ–∞–π–ª–æ–≤.

#### `read_excel(filename, excel_header, sheet_name, int_columns, date_columns, start_row)`
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è Excel —Ñ–∞–π–ª–æ–≤.

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å—Ç–∏–ª–µ–π

#### `BORDER`
–°–ª–æ–≤–∞—Ä—å —Å predefined —Å—Ç–∏–ª—è–º–∏ –≥—Ä–∞–Ω–∏—Ü:
- `BORDER['none']` - –±–µ–∑ –≥—Ä–∞–Ω–∏—Ü
- `BORDER['all']` - –≥—Ä–∞–Ω–∏—Ü—ã —Å–æ –≤—Å–µ—Ö —Å—Ç–æ—Ä–æ–Ω
- `BORDER['left']`, `BORDER['right']`, etc. - –≥—Ä–∞–Ω–∏—Ü—ã —Å –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω

#### `FONT`
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —à—Ä–∏—Ñ—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

#### `NUMBER_FORMAT`
–§–æ—Ä–º–∞—Ç—ã —á–∏—Å–µ–ª –¥–ª—è –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏.

## –ü—Ä–∏–º–µ—Ä—ã —Å—Ç–∏–ª–µ–π

```python
# –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã
header_style = {
    'bold': True,
    'border': BORDER['bottom'],
    'alignment': {'horizontal': 'center', 'wrap_text': True}
}

# –Ø—á–µ–π–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
cell_style = {
    'border': BORDER['all'],
    'alignment': {'horizontal': 'left'}
}

# –ß–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç
number_style = {
    'number_format': '#,##0.00',
    'alignment': {'horizontal': 'right'}
}

# –î–∞—Ç–∞
date_style = {
    'number_format': 'dd.mm.yyyy',
    'alignment': {'horizontal': 'center'}
}
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```python
from dgexcel import Excel, ImportError

try:
    excel = Excel()
    excel.create_simple_excel('test.xls', [{'data': 'test'}])
except ImportError as e:
    print("–î–ª—è —Ä–∞–±–æ—Ç—ã —Å .xls —Ñ–∞–π–ª–∞–º–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install dgexcel[xls]")
except Exception as e:
    print(f"–û—à–∏–±–∫–∞: {e}")
```

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å divinegift –≤–µ—Ä—Å–∏–∏

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏ –ø–∞–∫–µ—Ç–∞:

```python
# –°—Ç–∞—Ä—ã–π –∫–æ–¥
from divinegift.excel import create_excel, read_excel

# –ù–æ–≤—ã–π –∫–æ–¥
from dgexcel import create_excel, read_excel

# API –æ—Å—Ç–∞–µ—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º!
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Python**: 3.10+
- **–§–æ—Ä–º–∞—Ç—ã**: .xlsx, .xls
- **–ö–æ–¥–∏—Ä–æ–≤–∫–∞**: UTF-8

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## Changelog

### v1.0.0
- –ü–µ—Ä–≤—ã–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–µ–ª–∏–∑
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ .xlsx –∏ .xls —Ñ–æ—Ä–º–∞—Ç–æ–≤
- –ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ü–æ–ª–Ω—ã–π API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel —Ñ–∞–π–ª–∞–º–∏
