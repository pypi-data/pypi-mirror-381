{% from 'navigation.tmpl' import match %}
{% set TradeMark = Transaction.TradeMarkTransactionBody.TransactionContentDetails.TransactionData.TradeMarkDetails.TradeMark %}

{% set status = TradeMark.MarkCurrentStatusCode | translate_status %}
{% set appyear = TradeMark.ApplicationNumber | get_appyear %}

type: TRADEMARK
kind: {{TradeMark.KindMark | translate_kind }}
st13: {{ TradeMark.ApplicationNumber | st13('DK', appdate=appyear) }}

markFeature: {{ TradeMark.MarkFeature | translate_feature }}
registrationOfficeCode: {{ TradeMark.RegistrationOfficeCode }}
designatedCountries:
  - {{ TradeMark.RegistrationOfficeCode }}
applicationNumber: {{ TradeMark.ApplicationNumber }}
applicationDate: {{ TradeMark.ApplicationDate | convertdate('%Y-%m-%d') }}
registrationNumber: {{ TradeMark | get_registration_nb(TradeMark.MarkCurrentStatusCode)}}
registrationDate: {{ TradeMark.RegistrationDate }}
applicationLanguageCode: 'da'
expiryDate: {{ TradeMark.ExpiryDate }}
terminationDate: {{ TradeMark.MarkCurrentStatusDate | get_termination(status) }}
officeStatus: {{ TradeMark.MarkCurrentStatusCode }}
gbdStatus: {{ status }}
statusDate: {{ TradeMark.MarkCurrentStatusDate | convertdate('%Y-%m-%d') }}
markDisclaimerDetails:
  {% call(desc) match('MarkDisclaimerDetails.MarkDisclaimer', TradeMark) %}
  - text: {{ desc }}
    languageCode: {{ desc | guess_language(desc._languageCode, 'da') }}
  {% endcall %}
markDescriptionDetails:
  {% call(desc) match('MarkDescriptionDetails.MarkDescription', TradeMark) %}
  - text: {{ desc }}
    languageCode: {{ desc | guess_language(desc._languageCode, 'da') }}
  {% endcall %}
wordMarkSpecification:
  markVerbalElement:
    {% call(desc) match('WordMarkSpecification.MarkVerbalElementText', TradeMark) %}
    - text: {{ desc }}
      languageCode: {{ desc | guess_language(desc._languageCode, 'da') }}
    {% endcall %}
markImageDetails:
  {% call(img) match('MarkImageDetails.MarkImage', TradeMark) %}
  - name: {{ img.MarkImageURI }}
    classification:
      kind: Vienna
      code:
      {% call(code) match('MarkImageCategory.CategoryCodeDetails.CategoryCode', img) %}
        - {{ code }}
      {% endcall %}
  {% endcall %}

{% call(nc_gs) match('GoodsServicesDetails.GoodsServices', TradeMark) %}
goodsServicesClassification:
  kind: Nice
  version: {{ ASK_THE_OFFICE }}
  class:
    {% call(nice) match('ClassDescriptionDetails.ClassDescription', nc_gs) %}
    - code: {{ nice.ClassNumber | int }}
      terms:
      {% if nice.GoodsServicesDescription | has_value %}
      {% call(desc) match('GoodsServicesDescription', nice) %}
        {{ desc | guess_language(desc._languageCode, 'da') | field_name }}:
        {% for gsline in desc | remove_trailing('.') | split_terms %}
          - {{ gsline | lower }}
        {% endfor %}
      {% endcall %}
      {% endif %}
    {% endcall %}
{% endcall %}

priorities:
  {% call(priority) match('PriorityDetails.Priority', TradeMark) %}
    - countryCode: {{ priority.PriorityCountryCode }}
      number: {{ priority.PriorityNumber }}
      date: {{ priority.PriorityDate }}
  {% endcall %}

applicants:
  {% call(Applicant) match('ApplicantDetails.ApplicantKey.Applicant', TradeMark) %}
  - identifier: {{ Applicant.ApplicantIdentifier }}
    kind: {{ 'Legal entity' if Applicant.ApplicantLegalEntity else 'Natural person' }}
    fullName:
      {% call(nameline) match('FormattedNameAddress.Name.FormattedName', Applicant.ApplicantAddressBook) %}
      - text: {{ nameline | get_name}}
        languageCode: da
      {% endcall %}
    fullAddress:
      {% call(adrline) match('FormattedNameAddress.Address.FreeFormatAddress', Applicant.ApplicantAddressBook) %}
      - text: {{ adrline | get_addr}}
        languageCode: da
      {% endcall %}
    {% call(adrline) match('FormattedNameAddress.Address', Applicant.ApplicantAddressBook) %}
    countryCode: {{ adrline.AddressCountryCode }}
    {% endcall %}
  {% endcall %}

representatives:
  {% call(Representative) match('RepresentativeDetails.RepresentativeKey.Representative', TradeMark) %}
  - identifier: {{ Representative.RepresentativeIdentifier }}
    kind: {{ 'Legal entity' if Representative.RepresentativeLegalEntity else 'Natural person' }}
    fullName:
      {% call(nameline) match('FormattedNameAddress.Name.FormattedName', Representative.RepresentativeAddressBook) %}
      - text: {{ nameline | get_name}}
        languageCode: da
      {% endcall %}
    fullAddress:
      {% call(adrline) match('FormattedNameAddress.Address.FreeFormatAddress', Representative.RepresentativeAddressBook) %}
      - text: {{ adrline | get_addr}}
        languageCode: da
      {% endcall %}
    {% call(adrline) match('FormattedNameAddress.Address', Representative.RepresentativeAddressBook) %}
    countryCode: {{ adrline.AddressCountryCode }}
    {% endcall %}
  {% endcall %}
