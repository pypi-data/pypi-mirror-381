# This file is a sample of NornFlow settings. Alter it as needed to fit your project's requirements.
# You can create your own '<something>.yaml' file in the root of your project, keeping in mind that 
# NornFlow will try to find a settings YAML file through the following order:
# 1. The path specified in the environment variable 'NORNFLOW_SETTINGS'
# 2. The path passed to NornFlowSettings initializer (meaning using the 'nornflow --settings <path> ...')
# 3. The path 'nornflow.yaml' in the root of the project

######################
# MANDATORY SETTINGS #
######################

# Path for Nornir's config file
nornir_config_file: "nornir_configs/config.yaml"

######################
# OPTIONAL SETTINGS  #
######################

# List of paths to directories containing the Nornir tasks to be included in NornFlow's task_catalog. It
# defaults to a 'tasks' directory in the root of the project. The search is recursive, meaning that all 
# subdirectories will be searched as well.
local_tasks_dirs:
  - "tasks"

# List of paths to directories containing the Nornir workflows to be included in NornFlow's workflow_catalog. It
# defaults to a 'workflows' directory in the root of the project. The search is recursive, meaning that 
# all subdirectories will be searched as well. Be aware that all files with a .yaml or .yml extension will be
# considered as workflows.
local_workflows_dirs:
  - "workflows"

# List of paths to directories containing the Nornir filters to be included in NornFlow's filter_catalog. It
# defaults to a 'filters' directory in the root of the project. The search is recursive, meaning that all
# subdirectories will be searched as well.
local_filters_dirs:
  - "filters"

# List of python packages installed to your environment that contain Nornir tasks and Filter functions to be included in NornFlow's catalogs.
imported_packages: []

# If set to True, NornFlow will invoke Nornir in dry-run mode
dry_run: False

# Sets NornFlow's behavior when a task fails for a host during the execution of workflows.
# This setting can be overridden by CLI arguments (--failure-strategy) or workflow-specific definitions.
#
# FAILURE STRATEGY PRECEDENCE (highest to lowest priority):
# 1. CLI arguments (via --failure-strategy option)
# 2. Workflow-specific failure strategy defined in the workflow YAML file
# 3. Global failure strategy defined in this nornflow.yaml settings file
# 4. Default failure strategy ("skip-failed")
#
# Options:
# - skip-failed (default): When a task fails for a host, skip that host in all subsequent tasks within the workflow.
# - fail-fast: Halt workflow execution immediately upon detecting a task failure. Due to Nornir's multithreading nature,
#   ongoing threads may complete before NornFlow fully stops execution.
# - run-all: Execute all tasks for all hosts, including those that previously failed, until the entire workflow completes.
failure_strategy: "skip-failed"

# List of Nornir processors to be applied during task/workflow execution.
# If not provided, NornFlow will default to using only the DefaultNornFlowProcessor
# which takes no arguments.
#
# Structure:
#   - class: Full python dotted path to the processor class
#     args: An optional dictionary of keyword arguments passed to 
#           the processor constructor, if it accepts any.
#
# IMPORTANT: If you specify custom processors, the DefaultNornFlowProcessor will NOT
# be automatically included - you must explicitly add it if you still want its functionality.
#
# PROCESSOR CONFIGURATION PRECEDENCE (highest to lowest priority):
# 1. CLI arguments (via --processors or -p option)
# 2. Workflow-specific processors defined in the workflow YAML file
# 3. Global processors defined in this nornflow.yaml settings file
# 4. DefaultNornFlowProcessor (if no other processors are specified)
#
# CLI USAGE:
# Processors can be specified via command line using the --processors or -p option:
#   - Single processor: --processors "class='package.ProcessorClass',args={'key':'value'}"
#   - Multiple processors: --processors "class='package.Processor1',args={};class='package.Processor2',args={'key':'value'}"
#
processors:
  - class: "nornflow.builtins.DefaultNornFlowProcessor"
    args: {}

# Path to the directory containing variable files for NornFlow's templating system.
# This directory is used to store variables at different scopes:
#   - Global variables in "{vars_dir}/globals.yaml"
#   - Domain-specific variables in "{vars_dir}/{domain}/globals.yaml"
#
# Variable resolution follows this precedence (highest to lowest):
# 1. CLI variables (passed with --vars, there is no '-v' shortcut for this option)
# 2. Workflow-specific variables (from workflow YAML or paired _vars.yaml file)
# 3. Domain-specific global variables (from vars_dir/<domain>/globals.yaml)
# 4. Global variables (from vars_dir/globals.yaml)
# 5. Nornir inventory variables
# 6. Environment variables (with NORNFLOW_VAR_ prefix)
#
# If not specified, defaults to "vars" in the project root directory.
vars_dir: "vars"