# StockSplitFunds - 주식 분할 자금 전략

## 작성자 정보

- 작성자: 프로그램 동산
- 유튜브: https://youtube.com/@programgarden

## 개요

`StockSplitFunds`는 해외 주식 매수 시 자금을 균등하게 분할하여 여러 종목에 투자하는 전략입니다. 이 전략은 사용 가능한 예수금을 설정된 비율만큼 사용하여 최대 지정된 수의 종목에 균등하게 분배하여 매수 주문을 생성합니다.

## 개발 배경

해외 주식 투자의 핵심은 리스크 관리입니다. 기존 투자 방식에서는 투자자가 수동으로 자금을 분배하는 경우가 많았으나, 이는 비효율적이고 감정적 판단에 영향을 받기 쉽습니다. `StockSplitFunds`는 이러한 문제를 해결하기 위해 자동화된 자금 분배 시스템을 구현하여, 투자 효율성을 높이고 리스크를 체계적으로 관리하는 것을 목표로 합니다. 이를 통해 투자자는 보다 안정적이고 전략적인 포트폴리오 구성을 할 수 있습니다.

## 전략의 목적

해외 주식 투자는 개별 종목의 변동성으로 인해 큰 리스크를 동반합니다. 한 종목에 모든 자금을 집중 투자하면 해당 종목의 하락 시 큰 손실을 입을 수 있습니다. `StockSplitFunds`는 이러한 리스크를 분산시키기 위해 개발되었습니다:

- **리스크 분산**: 자금을 여러 종목에 균등하게 분배하여 포트폴리오의 전체 리스크를 줄입니다.
- **포트폴리오 다각화**: 다양한 종목에 투자함으로써 시장 변동에 대한 안정성을 높입니다.
- **자동화된 자금 관리**: 수동적인 자금 배분의 번거로움을 줄이고, 체계적인 투자 전략을 유지합니다.

## 주요 기능

### 클래스 구조
- **상속**: `BaseNewBuyOverseasStock`을 상속받아 표준화된 인터페이스를 따릅니다.
- **식별자**: `id = "StockSplitFunds"`
- **설명**: `description = "주식 분할 자금"`
- **지원 증권사**: `securities = ["ls-sec.co.kr"]`

### 파라미터
- `appkey` (Optional[str]): LS증권 API 앱키 (로그인용).
- `appsecretkey` (Optional[str]): LS증권 API 앱시크릿키 (로그인용).
- `percent_balance` (float, 기본값: 10.0): 현재 예수금의 몇 %를 사용할지 설정합니다. 예를 들어 10.0은 예수금의 10%를 사용합니다.
- `max_symbols` (float, 기본값: 5): 최대 몇 종목까지 매수할지 설정합니다.

### 동작 방식
1. LS증권 API에 로그인합니다 (필요 시).
2. 사용 가능한 예수금(`fcurr_dps`)에 `percent_balance`를 곱하여 사용할 총 자금을 계산합니다.
3. 총 자금을 `max_symbols`로 나누어 종목당 최대 매수 금액을 계산합니다.
4. 사용 가능한 심볼 목록을 순회합니다:
   - 각 심볼의 현재 가격을 조회합니다 (g3101 API 사용).
   - 종목당 최대 금액으로 살 수 있는 최대 수량(정수)을 계산합니다.
   - 수량이 1 이상인 경우 지정가 매수 주문을 생성합니다.
   - 최대 종목 수에 도달하면 중단합니다.
5. 생성된 주문 목록을 반환합니다.

## 사용 예시

```python
from programgarden_community.overseas_stock.new_buy_conditions.stock_split_funds import StockSplitFunds

# 예수금의 15%를 사용하여 최대 3종목 매수
split_funds = StockSplitFunds(
    appkey="your_appkey",
    appsecretkey="your_appsecretkey",
    percent_balance=15.0,
    max_symbols=3
)

# 전략 실행
results = await split_funds.execute()
```

## 주의사항

- 이 전략은 과거 데이터나 시뮬레이션에서 테스트된 후 실제 투자에 적용해야 합니다.
- API 키는 안전하게 관리해야 하며, 실제 투자 시 유효한 키를 사용하세요.
- 시장 상황에 따라 가격 변동이 발생할 수 있으므로, 주문 실행 전 충분한 검토를 권장합니다.
- 예수금 비율과 최대 종목 수는 투자자의 리스크 성향에 따라 조정해야 합니다.
